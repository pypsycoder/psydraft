<!DOCTYPE html>
<html lang="ru">
<head>
      <meta charset="UTF-8">
    <title>–ü—Å–∏—Ö–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞–∫–ª—é—á–µ–Ω–∏—è</title>

  <style>
    :root {
    --bg-main: #f2f2f7;
    --bg-card: #ffffff;
    --border-card: #e5e5ea;
    --accent: #007aff;
    --accent-soft: rgba(0,122,255,0.15);
    --text-main: #111111;
    --text-secondary: #6e6e73;
    --shadow-card: 0 8px 20px rgba(0,0,0,0.05);
    --radius-card: 14px;
    --transition-fast: 0.2s ease;
}

html {
    scroll-behavior: smooth;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    margin: 0;
    padding: 0;
    background: var(--bg-main);
    color: var(--text-main);
    font-size: 17px;
    line-height: 1.5;
}

/* ================== LAYOUT ================== */

.layout {
    max-width: 1200px;
    margin: 0 auto;
    padding: 16px 12px 32px;
    display: flex;       /* ‚Üê –∫–ª—é—á–µ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
    gap: 16px;
}

/* –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å–ø—Ä–∞–≤–∞ –æ—Ç —Å–∞–π–¥–±–∞—Ä–∞ */
.main {
    flex: 1;
    min-width: 0;
}

    /* ================== SIDEBAR ================== */

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∞–π–¥–±–∞—Ä–∞ ‚Äî –æ–±—ã—á–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å–ª–µ–≤–∞ –≤–æ flex-–ª–µ–π–∞—É—Ç–µ */
.sidebar {
    width: 240px;
    position: sticky;
    top: 12px;
    align-self: flex-start;
    background: #ffffff; /* –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–µ–ª—ã–π, –±–µ–∑ –æ—â—É—â–µ–Ω–∏—è ‚Äú–Ω–∞–ª–æ–∂–µ–Ω–∏—è‚Äù */
    border-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    border: 1px solid rgba(0,0,0,0.06);

    padding: 14px 14px 12px;

    display: flex;
    flex-direction: column;

    animation: slideIn 0.35s ease-out;
    transition:
        width var(--transition-fast),
        padding var(--transition-fast),
        transform var(--transition-fast),
        opacity var(--transition-fast);
}

/* –®–∞–ø–∫–∞ */
.sidebar-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}

.sidebar-toggle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    border-radius: 999px;
    border: none;
    padding: 0;
    background: var(--accent);
    color: #fff;
    cursor: pointer;

    box-shadow: 0 4px 10px rgba(0,122,255,0.30);
    transition:
        background var(--transition-fast),
        box-shadow var(--transition-fast),
        transform 0.12s ease;
}

.sidebar-toggle:hover {
    background: #0063d1;
    box-shadow: 0 6px 14px rgba(0,122,255,0.38);
    transform: translateY(-1px);
}

.sidebar-toggle svg {
    width: 20px;
    height: 20px;
}

.sidebar-title {
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    color: var(--text-secondary);
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ */
.sidebar-nav {
    margin-top: 4px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.sidebar-group-title {
    margin-top: 10px;
    margin-bottom: 2px;
    font-size: 15px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-secondary);
}

/* –°—Ç—Ä–æ–∫–∞ –º–µ–Ω—é */
.sidebar-link {
    display: flex;
    align-items: center;
    gap: 10px;

    width: 100%;
    padding: 6px 8px;
    border-radius: 12px;
    background: transparent; /* –±–æ–ª—å—à–µ –ù–ï–¢ –≥–æ–ª—É–±–æ–π –∑–∞–ª–∏–≤–∫–∏ */
    text-decoration: none;
    color: var(--text-primary);
    font-size: 14px;

    cursor: pointer;
    transition:
        background 0.12s ease,
        box-shadow 0.12s ease,
        transform 0.1s ease;
}

.sidebar-link:hover {
    background: rgba(0,0,0,0.04);
    box-shadow: 0 0 0 1px rgba(148,163,184,0.35);
    transform: translateX(1px);
}

/* –ò–∫–æ–Ω–∫–∞ */
.sidebar-link-icon {
    flex: 0 0 36px;
    height: 36px;

    border-radius: 12px;
    background: transparent; /* –Ω–µ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Ñ–æ–Ω */
    color: var(--accent);

    display: flex;
    align-items: center;
    justify-content: center;

    font-size: 20px;
    line-height: 1;

    transition: transform 0.12s ease;
}

.sidebar-link:hover .sidebar-link-icon {
    transform: scale(1.1);
}

/* –ü–æ–¥–ø–∏—Å—å */
.sidebar-link-label {
    white-space: nowrap;
}

/* –ß—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–≥–æ visited */
.sidebar-link:visited {
    color: var(--text-primary);
}

/* ===== –ê–ö–¢–ò–í–ù–ê–Ø –°–ï–ö–¶–ò–Ø ‚Äî –º—è–≥–∫–æ–µ –≥–æ–ª—É–±–æ–µ –∫–æ–ª—å—Ü–æ ===== */
.sidebar-link.active {
    background: transparent;
    box-shadow:
        0 0 0 2px rgba(59,130,246,0.55),
        0 4px 10px rgba(59,130,246,0.22);
    transform: translateX(1px);
}

.sidebar-link.active .sidebar-link-icon {
    transform: scale(1.1);
}

/* ===== –°–≤–µ—Ä–Ω—É—Ç—ã–π —Ä–µ–∂–∏–º: —Ç–æ–ª—å–∫–æ –∏–∫–æ–Ω–∫–∏ ===== */

body.sidebar-collapsed .sidebar {
    width: 60px;
    padding-inline: 6px;
}

body.sidebar-collapsed .sidebar-title,
body.sidebar-collapsed .sidebar-group-title {
    display: none;
}

body.sidebar-collapsed .sidebar-link-label {
    display: none;
}

body.sidebar-collapsed .sidebar-link {
    justify-content: center;
    padding-inline: 0;
}

body.sidebar-collapsed .sidebar-header {
    justify-content: center;
}

body.sidebar-collapsed .sidebar-toggle {
    width: 36px;
    height: 36px;
}

/* ============================= */
/*   –ê–π—Ñ–æ–Ω–æ–≤—Å–∫–∏–π —Å—Ç–∏–ª—å —Å–µ–∫—Ü–∏–π    */
/* ============================= */

.section {
    margin-bottom: 28px;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–æ–º —Ñ–æ–Ω–µ */
.section > h2,
.section-heading {
    margin: 0 0 10px;
    padding: 8px 14px;

    font-size: 20px;
    font-weight: 700;

    border-radius: 12px;
    background: #f2f3f5;   /* —Å–≤–µ—Ç–ª—ã–π —Å–µ—Ä—ã–π */
    color: #1f2937;        /* —Ç—ë–º–Ω–æ-—Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç */
}

/* –ë–µ–ª–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º */
.section-card {
    background: #ffffff;
    border-radius: 16px;
    padding: 14px 16px;

    border: 1px solid rgba(0,0,0,0.08);
    box-shadow:
        0 1px 3px rgba(0,0,0,0.05),
        0 10px 20px rgba(0,0,0,0.03);

    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* –ü–æ–ª—è –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ —á—É—Ç—å –∫—Ä—É–ø–Ω–µ–µ –∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º —Ñ–æ–∫—É—Å–æ–º */
.section-card textarea,
.section-card input[type="text"],
.section-card input[type="number"] {
    font-size: 15px;
    padding: 8px 10px;
    border-radius: 10px;
    border: 1px solid #d1d5db;
}

.section-card textarea:focus,
.section-card input[type="text"]:focus,
.section-card input[type="number"]:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(0,122,255,0.15);
}

/* --- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –≤—Å–µ—Ö –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —Å–µ–∫—Ü–∏–π --- */

.section {
    margin-bottom: 28px;

    /* —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –±–µ–ª—ã–π —Ñ–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–ª–∏–ø –∫ section */
    background: transparent !important;
    padding: 0 !important;
    border: none !important;
    box-shadow: none !important;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ (—Å–µ—Ä—ã–π —Ñ–æ–Ω, –∫–∞–∫ –≤ iOS) */
.section > h2 {
    margin: 0 0 12px;
    padding: 10px 14px;
    font-size: 20px;
    font-weight: 700;
    border-radius: 12px;
    background: #f2f3f5;
    color: #1f2937;
}

/* ==== –°—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ ==== */

.suicide-history {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-bottom: 6px;
}

.suicide-history .checkbox-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
}

.suicide-inline-input {
    width: 90px;
    max-width: 120px;
    font-size: 14px;
    padding: 4px 6px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
}

.suicide-inline-input:disabled {
    background-color: #f9fafb;
    color: #9ca3af;
}

    /* Apple Health inspired theme accents */
.page-footer {
    text-align: center;
    padding: 16px;
    color: var(--text-secondary);
    font-size: 14px;
}

    .section {
    background: var(--bg-card);
    border-radius: var(--radius-card);
    padding: 16px 18px 18px;
    margin-bottom: 18px;
    box-shadow: var(--shadow-card);
    border: 1px solid var(--border-card);
    animation: fadeInUp 0.35s ease-out;
}

h2 {
    font-size: 20px;
    margin-top: 0;
    margin-bottom: 10px;
    font-weight: 600;
    color: #111;
}

.status-subsection {
    margin-top: 18px;
    padding: 12px;
    border-radius: 12px;
    background: #fbfbfd;
    border: 1px solid #e1e4eb;
}

.status-subsection h3 {
    margin: 4px 0 10px;
    font-size: 17px;
    font-weight: 700;
    letter-spacing: 0.01em;
}

.subgroup-grid {
    display: grid;
    gap: 12px;
}

    label {
    font-weight: 600;
    margin-top: 12px;
    display: block;
    color: #1c1c1e;
}

textarea,
select,
input[type="text"],
input[type="number"] {
    width: 100%;
    font-family: inherit;
    font-size: 16px;
    padding: 8px 10px;
    margin-top: 6px;
    border-radius: 10px;
    border: 1px solid #ced0d8;
    background: #ffffff;
    box-sizing: border-box;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background-color var(--transition-fast), transform 0.1s ease;
}

/* –û–ø–∏—Å–∞–Ω–∏–µ —Ä—è–¥–æ–º —Å —á–µ–∫–±–æ–∫—Å–æ–º: –Ω–µ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É, –∞ –∑–∞–Ω–∏–º–∞—Ç—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
.illusion-description,
.hallucination-description,
.perception-description,
.idea-description {
    width: auto;
    flex: 1 1 220px;
    min-width: 180px;
}

textarea {
    resize: vertical;
    min-height: 48px;
}

textarea:focus,
select:focus,
input:focus {
    border-color: var(--accent);
    outline: none;
    box-shadow: 0 0 0 3px var(--accent-soft);
    background: #ffffff;
    transform: translateY(-1px);
}

select {
    appearance: none;
    background-image: linear-gradient(45deg, transparent 50%, #999 50%), linear-gradient(135deg, #999 50%, transparent 50%);
    background-position: calc(100% - 14px) calc(50% - 3px), calc(100% - 9px) calc(50% - 3px);
    background-size: 6px 6px, 6px 6px;
    background-repeat: no-repeat;
}

input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

input[type="number"] {
    -moz-appearance: textfield;
}

.buttons {
    text-align: center;
    margin: 20px 0;
}

button {
    padding: 10px 18px;
    font-size: 16px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    margin-right: 10px;
    background: var(--accent);
    color: white;
    transition: background var(--transition-fast), transform 0.1s ease, box-shadow var(--transition-fast);
    box-shadow: 0 6px 14px rgba(0,122,255,0.35);
}

button:hover {
    background: #0063d1;
    box-shadow: 0 8px 18px rgba(0,122,255,0.45);
    transform: translateY(-1px);
}

button:active {
    transform: translateY(0);
    box-shadow: 0 4px 10px rgba(0,122,255,0.35);
}

.btn-secondary {
    background: #e5e5ea;
    color: #111;
    box-shadow: none;
}

.btn-secondary:hover {
    background: #d1d1d6;
    box-shadow: none;
}

    .checkbox-item {
    font-size: 15px;
    color: #1c1c1e;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
}

.checkbox-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--accent);
    cursor: pointer;
}

    .multicheck-group {
    margin-top: 10px;
}

.multicheck-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 10px;
    border-radius: 10px;
    border: 1px solid #ced0d8;
    background: #ffffff;
    cursor: pointer;
    transition: background var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast), transform 0.1s ease;
}

.multicheck-header:hover {
    background: #f9fafc;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.multicheck-label {
    font-weight: 600;
    color: #1c1c1e;
    font-size: 15px;
}

.multicheck-summary {
    font-size: 14px;
    color: var(--text-secondary);
    margin-left: 10px;
    text-align: right;
}

.multicheck-body {
    margin-top: 6px;
    border-radius: 10px;
    border: 1px solid #e1e4eb;
    background: #fbfbfd;
    padding: 8px 10px;
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 4px 12px;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transform: translateY(-4px);
    transition: max-height 0.25s ease, opacity 0.22s ease, transform 0.25s ease;
}

.multicheck-body.open {
    max-height: 260px;
    opacity: 1;
    transform: translateY(0);
}

    .idea-row,
.perception-row {
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    gap: 10px 12px;
    padding: 8px 12px;
}

/* –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Ä–∞–º–∫–æ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –±–ª–æ–∫–∞ –æ–±–º–∞–Ω–æ–≤ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è */
#status-perception .perception-row {
    border: none;
    background: none;
    padding: 8px 0;
}

.idea-description,
.perception-description,
.hallucination-description-input {
    flex: 1 1 200px;
    min-width: 180px;
    padding: 8px 10px;
    border-radius: 10px;
    border: 1px solid #ced0d8;
    font-size: 15px;
}

.perception-columns,
.psychosensory-columns {
    display: grid;
    gap: 10px;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.perception-card {
    background: #ffffff;
    border: 1px solid #e1e4eb;
    border-radius: 12px;
    padding: 10px 12px;
}

.perception-card h4 {
    margin: 0 0 8px;
    font-size: 15px;
    color: #1c1c1e;
}

.perception-group {
    border: 1px solid #e1e4eb;
    border-radius: 12px;
    background: #ffffff;
    padding: 0;
    margin-top: 10px;
}

.perception-group summary {
    list-style: none;
    cursor: pointer;
    padding: 8px 12px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
}

.perception-group summary::marker {
    content: "";
}

.perception-group[open] {
    box-shadow: 0 6px 16px rgba(0,0,0,0.04);
}

.perception-summary::before {
    content: "‚ñ∏";
    display: inline-block;
    transition: transform 0.2s ease;
    font-size: 12px;
    color: #8e8e93;
}

.perception-group[open] .perception-summary::before {
    transform: rotate(90deg);
}

.perception-inner {
    padding: 6px 12px 12px;
    border-top: 1px solid #e1e4eb;
}

.perception-row {
    margin-top: 6px;
}

.perception-row-inline {
    display: grid;
    grid-template-columns: minmax(0, 230px) 1fr;
    gap: 6px 12px;
    align-items: center;
    margin-top: 6px;
}

.perception-columns-analyzer {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 4px 12px;
    margin-bottom: 8px;
}

.attention-group {
    background: #ffffff;
    border: 1px solid #e1e4eb;
    border-radius: 12px;
    padding: 10px 12px;
}

.attention-group .group-title {
    font-weight: 700;
    margin-bottom: 6px;
    color: #1c1c1e;
}

    #result-container {
    border-radius: var(--radius-card);
    padding: 10px 12px;
    background: #ffffff;
    box-shadow: inset 0 0 6px rgba(0,0,0,0.06);
    border: 1px solid #d1d1d6;
    min-height: 260px;
}

#result {
    min-height: 240px;
    outline: none;
    font-family: inherit;
    font-size: 16px;
}

#result strong {
    color: #000;
    font-weight: 600;
}

    @keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(6px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(-8px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

    /* ===== –°–ï–¢–ö–ê –ö–ê–†–¢–û–ß–ï–ö ===== */

.rec-grid {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 16px !important;
    margin: 12px 0 20px !important;
}

/* –û–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–æ–≤—Å–µ–º —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
@media (max-width: 600px) {
    .rec-grid {
        grid-template-columns: 1fr !important;
    }
}

/* ===== –ö–ê–†–¢–û–ß–ö–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò ===== */

.rec-card {
    background: #ffffff;
    border-radius: 12px;
    padding: 12px 14px;
    border: 1px solid rgba(0, 122, 255, 0.15);
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.04);

    display: flex;
    flex-direction: column;
    gap: 8px;
}

.rec-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 15px;
}

.rec-title input[type="checkbox"] {
    accent-color: var(--accent);
}

.rec-modes {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 16px;
    font-size: 15px;
    color: #555;
}

.rec-modes input[type="radio"] {
    accent-color: var(--accent);
}

.rec-text {
    font-size: 15px;
    line-height: 1.45;    /* —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –¥—ã—à–∞–ª */
    background: #fafafa;
    border-radius: 10px;
    padding: 8px 10px;
    border: 1px solid #ededed;
    white-space: pre-wrap;
}

/* ===== –®–ê–ü–ö–ê –ò –ù–ò–ó –ë–õ–û–ö–ê ===== */

.library-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    gap: 12px;
    margin-bottom: 8px;
}

.library-top .small-note {
    flex: 1;
}

.selected-count {
    font-size: 13px;
    color: var(--text-secondary);
}

.library-footer {
    margin: 4px 0 10px;
    display: flex;
    justify-content: flex-end;
}

.library-footer button {
    /* –µ—Å–ª–∏ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å –æ–±—â–∏–π .btn, –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å */
    padding: 8px 14px;
    border-radius: 999px;
    border: none;
    background: var(--accent);
    color: #fff;
    font-size: 14px;
    cursor: pointer;
}

    /* –ë–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ / —Ä–∞–∑–¥–µ–ª ‚Ñû */

#section-prescriptions .prescription-editor,
#section-prescriptions .prescription-editor input,
#section-prescriptions .prescription-editor textarea,
#section-prescriptions .prescription-editor select,
#section-prescriptions .prescriptions-list {
    font-size: 15px;
}

.prescription-editor {
    margin-top: 8px;
    padding: 12px 14px;
    border-radius: 14px;
    background: #fafbff;
    border: 1px solid #dde2f0;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.03);
}

.prescription-editor-row {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 10px;
    align-items: flex-end;
}

.prescription-field {
    flex: 1 1 220px;
    min-width: 200px;
}

.prescription-field.full-width {
    flex-basis: 100%;
}

.prescription-field-inline {
    max-width: 260px;
}

.prescription-label-small {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 4px;
    display: block;
}

.rx-input-wide {
    width: 100%;
    padding: 7px 9px;
    border-radius: 8px;
    border: 1px solid #d5d8e3;
    font-size: 15px;
    background: #fff;
}

.rx-input-wide:focus,
.rx-dose-input:focus,
.rx-textarea:focus,
#rx-duration-value:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 1px rgba(74, 118, 255, 0.18);
}

/* ========== –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ========== */

.rx-duration-row {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: nowrap; /* –¥–µ—Ä–∂–∏–º –≤—Å—ë –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ */
}

#rx-duration-value {
    padding: 4px 6px;
    border-radius: 8px;
    border: 1px solid #d5d8e3;
    font-size: 15px;
    width: 3.2em;   /* –ø—Ä–∏–º–µ—Ä–Ω–æ 4 —Å–∏–º–≤–æ–ª–∞ */
    min-width: 0;
    background: #fff;
    text-align: right;
}

.rx-duration-type {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 14px;
    color: var(--text-secondary);
}

/* –£–∫–æ—Ä–∞—á–∏–≤–∞–µ–º –ø–æ–ª–µ "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞", —Ä–∞—Å—à–∏—Ä—è–µ–º –±–ª–æ–∫ "–í —Ç–µ—á–µ–Ω–∏–µ" */
#section-prescriptions .prescription-editor-row:first-child .prescription-field:first-child {
    flex: 1.6 1 320px;          /* —Å—Ç–∞–ª–æ —á—É—Ç—å –∫–æ—Ä–æ—á–µ */
}

#section-prescriptions .prescription-editor-row:first-child .prescription-field:nth-child(2) {
    flex: 1.2 1 260px;          /* —á—É—Ç—å —à–∏—Ä–µ */
    max-width: 260px;
}

/* ========== –°–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏—ë–º–∞ ========== */
/* 4 –∫–æ–ª–æ–Ω–∫–∏: —Å–≤–µ—Ä—Ö—É –≤—Ä–µ–º—è, —Å–Ω–∏–∑—É ‚Äì –º–≥ */

.rx-times-grid {
    display: grid;
    grid-template-columns: repeat(4, minmax(90px, 1fr));
    gap: 6px 10px;
    margin-top: 4px;
}

.rx-time-cell {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 4px;
}

.rx-time-label {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 15px;
    white-space: nowrap;
}

.rx-time-label input[type="checkbox"] {
    width: 15px;
    height: 15px;
    accent-color: var(--accent);
}

.rx-dose-input {
    width: 100%;
    max-width: 80px;
    padding: 4px 6px;
    border-radius: 8px;
    border: 1px solid #d5d8e3;
    font-size: 15px;
}

.rx-dose-input:disabled {
    background: #f3f4f8;
    color: #9ca3b5;
}

/* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */

.rx-textarea {
    width: 100%;
    padding: 7px 9px;
    border-radius: 8px;
    border: 1px solid #d5d8e3;
    font-size: 15px;
    resize: vertical;
    min-height: 52px;
    max-height: 130px;
}

/* –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */

.prescription-editor-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 6px;
}

/* –°–ø–∏—Å–æ–∫ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π */

.prescriptions-list-header {
    margin-top: 14px;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-secondary);
}

.prescriptions-list {
    margin-top: 4px;
}

.prescriptions-empty {
    margin-top: 6px;
    font-size: 14px;
    color: var(--text-tertiary, #969cb3);
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–¥–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è */

.prescription-item {
    margin-top: 10px;
    padding: 10px 12px;
    border-radius: 12px;
    background: #fafafa;
    border: 1px solid #e1e4eb;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
    animation: fadeInUp 0.25s ease-out;
}

.prescription-main-row {
    display: flex;
    justify-content: space-between;
    gap: 8px;
    align-items: flex-start;
    flex-wrap: wrap;
}

.prescription-main-text {
    flex: 1 1 auto;
    min-width: 220px;
    font-size: 15px;
}

.prescription-title {
    font-weight: 600;
    margin-bottom: 2px;
}

.prescription-subline {
    font-size: 14px;
    color: var(--text-secondary);
}

.prescription-comment-row {
    margin-top: 4px;
    font-size: 14px;
    color: var(--text-secondary);
}

.prescription-comment-label {
    font-weight: 500;
}

/* ========== –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (‚úèÔ∏è –∏ ‚ùå) ========== */
/* –ú–∏–Ω–∏–º–∞–ª–∏–∑–º: –±–µ–∑ —Ñ–æ–Ω–∞, —Å —Å–µ—Ä–æ–π —Ç–µ–Ω—å—é */

.prescription-actions {
    display: flex;
    flex-direction: row;
    gap: 4px;
}

.prescription-action-btn {
    border: none;
    border-radius: 999px;
    padding: 4px 8px;
    font-size: 16px;
    cursor: pointer;
    background: transparent;
    color: #6b7280; /* —Å–µ—Ä–∞—è –∏–∫–æ–Ω–∫–∞ */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 1px 4px rgba(0,0,0,0.18);
    transition: box-shadow 0.15s ease-out, transform 0.1s ease-out;
}

.prescription-action-btn span {
    line-height: 1;
}

.prescription-action-btn.danger {
    /* –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ñ–æ–Ω–∞, —Ç–æ–ª—å–∫–æ —Ç–∞–∫–æ–π –∂–µ —Å–µ—Ä—ã–π —Å—Ç–∏–ª—å */
}

.prescription-action-btn:hover {
    box-shadow: 0 2px 7px rgba(0,0,0,0.26);
    transform: translateY(-1px);
}

/* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π, —á—Ç–æ–±—ã –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞—Ç—å) */

.prescriptions-controls {
    margin-top: 8px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è */

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(4px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

  </style>
</head>
<body>

  <div class="layout">
    <!-- –°–∞–π–¥–±–∞—Ä —Å–ª–µ–≤–∞ -->
    <nav class="sidebar">
    <div class="sidebar-header">
        <button
            type="button"
            class="sidebar-toggle"
            onclick="toggleSidebar()"
            aria-label="–°–≤–µ—Ä–Ω—É—Ç—å –∏–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é"
        >
            <svg width="26" height="26" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect>
  <line x1="8" y1="4" x2="8" y2="20"></line>
  <line x1="5.5" y1="8" x2="5.5" y2="8"></line>
  <line x1="5.5" y1="12" x2="5.5" y2="12"></line>
  <line x1="5.5" y1="16" x2="5.5" y2="16"></line>
</svg>

        </button>
        <div class="sidebar-title">–ù–ê–í–ò–ì–ê–¶–ò–Ø</div>
    </div>

    <div class="sidebar-nav">
        <div class="sidebar-group-title">–ñ–∞–ª–æ–±—ã –∏ –∞–Ω–∞–º–Ω–µ–∑</div>
        <a href="#section-general" class="sidebar-link sidebar-link--active">
            <span class="sidebar-link-icon">üìã</span>
            <span class="sidebar-link-label">–û–±—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã</span>
        </a>

        <div class="sidebar-group-title">–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å</div>
        <a href="#status-consciousness" class="sidebar-link">
            <span class="sidebar-link-icon">üß†</span>
            <span class="sidebar-link-label">–°–æ–∑–Ω–∞–Ω–∏–µ</span>
        </a>
        <a href="#status-thinking" class="sidebar-link">
            <span class="sidebar-link-icon">üí≠</span>
            <span class="sidebar-link-label">–ú—ã—à–ª–µ–Ω–∏–µ</span>
        </a>
        <a href="#status-intellect" class="sidebar-link">
            <span class="sidebar-link-icon">üìö</span>
            <span class="sidebar-link-label">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç</span>
        </a>
        <a href="#status-perception" class="sidebar-link">
            <span class="sidebar-link-icon">üëÅÔ∏è</span>
            <span class="sidebar-link-label">–û–±–º–∞–Ω—ã –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è</span>
        </a>
        <a href="#status-memory" class="sidebar-link">
            <span class="sidebar-link-icon">üß©</span>
            <span class="sidebar-link-label">–ü–∞–º—è—Ç—å</span>
        </a>
        <a href="#status-mood" class="sidebar-link">
            <span class="sidebar-link-icon">üôÇ</span>
            <span class="sidebar-link-label">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span>
        </a>
        <a href="#status-motor" class="sidebar-link">
            <span class="sidebar-link-icon">üèÉ</span>
            <span class="sidebar-link-label">–î–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞</span>
        </a>
        <a href="#status-attention" class="sidebar-link">
            <span class="sidebar-link-icon">üéØ</span>
            <span class="sidebar-link-label">–í–Ω–∏–º–∞–Ω–∏–µ</span>
        </a>
        <a href="#status-insight" class="sidebar-link">
            <span class="sidebar-link-icon">üîç</span>
            <span class="sidebar-link-label">–ö—Ä–∏—Ç–∏–∫–∞ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é</span>
        </a>
        <a href="#status-sleep-appetite" class="sidebar-link">
            <span class="sidebar-link-icon">üåô</span>
            <span class="sidebar-link-label">–°–æ–Ω, –∞–ø–ø–µ—Ç–∏—Ç</span>
        </a>

        <div class="sidebar-group-title">–ò—Ç–æ–≥</div>
        <a href="#section-diagnosis" class="sidebar-link">
            <span class="sidebar-link-icon">ü©∫</span>
            <span class="sidebar-link-label">–î–∏–∞–≥–Ω–æ–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span>
        </a>
        <a href="#section-prescriptions" class="sidebar-link">
            <span class="sidebar-link-icon">‚Ñû</span>
            <span class="sidebar-link-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è</span>
        </a>
        <a href="#section-result" class="sidebar-link">
            <span class="sidebar-link-icon">üìù</span>
            <span class="sidebar-link-label">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</span>
        </a>
    </div>
</nav>


    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø—Ä–∞–≤–∞ -->
    <div class="main">
      <div class="page-header">
    <h1>ùöø –®–∞–±–ª–æ–Ω –∑–∞–∫–ª—é—á–µ–Ω–∏—è –ø—Å–∏—Ö–∏–∞—Ç—Ä–∞ ùöø</h1>
    <p class="small-note">
        –ó–∞–ø–æ–ª–Ω–∏ –ø–æ–ª—è –Ω–∏–∂–µ, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏ <b>¬´–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç¬ª</b>. –ì–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤–Ω–∏–∑—É ‚Äî –µ–≥–æ –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤
        –∏—Å—Ç–æ—Ä–∏—é/Word.
    </p>
</div>


      <!-- –û–±—â–∏–π —Ä–∞–∑–¥–µ–ª -->
      <div class="section" id="section-general">
    <h2>üìã –û–±—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã</h2>

    <div class="section-card">

        <label>–ñ–∞–ª–æ–±—ã:</label>
        <textarea id="complaints"></textarea>

        <label>–ê–Ω–∞–º–Ω–µ–∑ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</label>
        <textarea id="anamnesis"></textarea>

        <label>–°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —É—á–µ—Ç–µ –≤ –ü–ù–î –∏ –Ω–∞—Ä–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–µ:</label>
        <textarea id="dispensary_status"></textarea>

        <label>–õ–µ—á–µ–Ω–∏–µ –≤ –ü–ù–î –∏ –Ω–∞—Ä–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–µ:</label>
        <textarea id="dispensary_treatment"></textarea>

        <label>–°—á–∏—Ç–∞–µ—Ç —Å–µ–±—è –±–æ–ª—å–Ω—ã–º –≤ —Ç–µ—á–µ–Ω–∏–µ (–¥–Ω–µ–π):</label>
        <input type="number" id="ill_days" min="0" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 30">

        <label>–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ:</label>
        <textarea id="self_treatment"></textarea>

        <label>–î–∏–Ω–∞–º–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</label>
        <textarea id="dynamics"></textarea>

        <label>–ê–Ω–∞–º–Ω–µ–∑ –∂–∏–∑–Ω–∏:</label>
        <textarea id="life_history"></textarea>

    </div>
</div>


      <!-- –ë–ª–æ–∫ –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ -->
      <div class="section" id="section-status">
    <h2>–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å</h2>

    <div id="status-consciousness" class="status-subsection">
                <h3>üß† –°–æ–∑–Ω–∞–Ω–∏–µ</h3>
                <div class="subgroup-grid">
                    <div>
                        <label>–°–æ–∑–Ω–∞–Ω–∏–µ:</label>
                        <select id="consciousness">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–Ω–µ –ø–æ–º—Ä–∞—á–µ–Ω–æ</option>
                            <option>–ø–æ–º—Ä–∞—á–µ–Ω–æ (–¥–µ–ª–∏—Ä–∏–π)</option>
                            <option>–ø–æ–º—Ä–∞—á–µ–Ω–æ (–æ–Ω–µ–π—Ä–æ–∏–¥)</option>
                            <option>–ø–æ–º—Ä–∞—á–µ–Ω–æ (—Å—É–º–µ—Ä–µ—á–Ω–æ–µ)</option>
                            <option>–ø–æ–º—Ä–∞—á–µ–Ω–æ (–∞–º–µ–Ω—Ü–∏—è)</option>
                        </select>
                    </div>

                    <div class="multicheck-group" data-name="appearance">
                        <div class="multicheck-header" onclick="toggleMultiGroup('appearance')">
                            <span class="multicheck-label">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                            <span class="multicheck-summary" id="appearance_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                        </div>

                        <div class="multicheck-body" id="appearance_body">
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance" value="–æ–ø—Ä—è—Ç–Ω—ã–π"
                                       onchange="updateAppearance()">
                                –æ–ø—Ä—è—Ç–Ω—ã–π
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance" value="–Ω–µ–æ–ø—Ä—è—Ç–Ω—ã–π"
                                       onchange="updateAppearance()">
                                –Ω–µ–æ–ø—Ä—è—Ç–Ω—ã–π
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance"
                                       value="–≤—ã–≥–ª—è–¥–∏—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º"
                                       onchange="updateAppearance()">
                                —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç—É
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance"
                                       value="–≤—ã–≥–ª—è–¥–∏—Ç –º–æ–ª–æ–∂–µ –≤–æ–∑—Ä–∞—Å—Ç–∞"
                                       onchange="updateAppearance()">
                                –º–æ–ª–æ–∂–µ –≤–æ–∑—Ä–∞—Å—Ç–∞
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance"
                                       value="–≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç–∞—Ä—à–µ –≤–æ–∑—Ä–∞—Å—Ç–∞"
                                       onchange="updateAppearance()">
                                —Å—Ç–∞—Ä—à–µ –≤–æ–∑—Ä–∞—Å—Ç–∞
                            </label>

                            <!-- –î—Ä—É–≥–æ–µ -->
                            <label class="checkbox-item">
                                <input type="checkbox" name="appearance" value="D_OTHER"
                                       onchange="toggleAppearanceOther(this); updateAppearance()">
                                –¥—Ä—É–≥–æ–µ:
                            </label>

                            <input type="text"
                                   id="appearance_other"
                                   placeholder="—É—Ç–æ—á–Ω–∏—Ç–µ..."
                                   style="display:none; margin-left: 15px;"
                                   oninput="updateAppearance()">

                            <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (—Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ, –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è) -->
                            <input type="hidden" id="appearance">
                        </div>
                    </div>



                    <div>
                        <label>–ó—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç:</label>
                        <select id="eye_contact">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π</option>
                            <option>–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–π</option>
                            <option>–Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç</option>
                        </select>
                    </div>

                    <div>
                        <label>–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞:</label>
                        <select id="contact">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Ö–æ—Ç–Ω–æ</option>
                            <option>—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–æ—Ö–æ—Ç–Ω–æ</option>
                            <option>—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç "—Ñ–æ—Ä–º–∞–ª—å–Ω–æ"</option>
                            <option>—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∞</option>
                            <option>–Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç</option>
                        </select>
                    </div>
                </div>

                <div class="multicheck-group" data-name="behavior">
                    <div class="multicheck-header" onclick="toggleMultiGroup('behavior')">
                        <span class="multicheck-label">–ü–æ–≤–µ–¥–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="behavior_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="behavior_body">
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="—Å–ø–æ–∫–æ–µ–Ω" onchange="updateMultiSummary('behavior')">—Å–ø–æ–∫–æ–µ–Ω</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="—É–ø–æ—Ä—è–¥–æ—á–µ–Ω" onchange="updateMultiSummary('behavior')">—É–ø–æ—Ä—è–¥–æ—á–µ–Ω</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="—Å—É–µ—Ç–ª–∏–≤" onchange="updateMultiSummary('behavior')">—Å—É–µ—Ç–ª–∏–≤</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="–±–µ—Å–ø–æ–∫–æ–µ–Ω" onchange="updateMultiSummary('behavior')">–±–µ—Å–ø–æ–∫–æ–µ–Ω</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="–Ω–µ–≥–∞—Ç–∏–≤–∏–∑–º" onchange="updateMultiSummary('behavior')">–Ω–µ–≥–∞—Ç–∏–≤–∏–∑–º</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="–≥—Ä—É–±" onchange="updateMultiSummary('behavior')">–≥—Ä—É–±</label>
                        <label class="checkbox-item"><input type="checkbox" name="behavior" value="–∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω" onchange="updateMultiSummary('behavior')">–∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω</label>
                        <!-- ... –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è ... -->
                        <label class="checkbox-item">
                            <input
                                type="checkbox"
                                name="behavior"
                                value="D_OTHER"
                                onchange="toggleOtherField('behavior')"
                            >
                            –¥—Ä—É–≥–æ–µ
                        </label>
                        <input
                            type="text"
                            id="behavior_other"
                            maxlength="100"
                            placeholder="—É—Ç–æ—á–Ω–∏—Ç–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è"
                            oninput="updateMultiSummary('behavior')"
                            style="display:none"
                        >
                    </div>
                </div>

                <div class="multicheck-group" data-name="facial_expression">
                    <div class="multicheck-header" onclick="toggleMultiGroup('facial_expression')">
                        <span class="multicheck-label">–ú–∏–º–∏–∫–∞ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="facial_expression_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="facial_expression_body">
                        <label class="checkbox-item"><input type="checkbox" name="facial_expression" value="—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏" onchange="updateMultiSummary('facial_expression')">—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏</label>
                        <label class="checkbox-item"><input type="checkbox" name="facial_expression" value="–æ–∂–∏–≤–ª–µ–Ω–Ω–∞—è" onchange="updateMultiSummary('facial_expression')">–æ–∂–∏–≤–ª–µ–Ω–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="facial_expression" value="–±–µ–¥–Ω–∞—è" onchange="updateMultiSummary('facial_expression')">–±–µ–¥–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="facial_expression" value="–∂–∏–≤–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞" onchange="updateMultiSummary('facial_expression')">–∂–∏–≤–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞</label>
                        <label class="checkbox-item"><input type="checkbox" name="facial_expression" value="–Ω–∞—Ä–æ—á–∏—Ç–∞—è –∂–∏–≤–æ—Å—Ç—å" onchange="updateMultiSummary('facial_expression')">–Ω–∞—Ä–æ—á–∏—Ç–∞—è –∂–∏–≤–æ—Å—Ç—å</label>
                    </div>
                </div>

                <div class="multicheck-group" data-name="conversation">
                    <div class="multicheck-header" onclick="toggleMultiGroup('conversation')">
                        <span class="multicheck-label">–ë–µ—Å–µ–¥—É–µ—Ç (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="conversation_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="conversation_body">
                        <label class="checkbox-item"><input type="checkbox" name="conversation" value="–ø–æ-–¥–µ–ª–æ–≤–æ–º—É" onchange="updateMultiSummary('conversation')">–ø–æ-–¥–µ–ª–æ–≤–æ–º—É</label>
                        <label class="checkbox-item"><input type="checkbox" name="conversation" value="–∫–æ—Å–Ω–æ" onchange="updateMultiSummary('conversation')">–∫–æ—Å–Ω–æ</label>
                        <label class="checkbox-item"><input type="checkbox" name="conversation" value="—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ" onchange="updateMultiSummary('conversation')">—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ</label>
                        <label class="checkbox-item"><input type="checkbox" name="conversation" value="—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∂–∞—Ä–≥–æ–Ω–∞" onchange="updateMultiSummary('conversation')">—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∂–∞—Ä–≥–æ–Ω–∞</label>
                    </div>
                </div>

                <div class="multicheck-group" data-name="answers">
                    <div class="multicheck-header" onclick="toggleMultiGroup('answers')">
                        <span class="multicheck-label">–ù–∞ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="answers_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="answers_body">
                        <label class="checkbox-item"><input type="checkbox" name="answers" value="–ø–æ —Å—É—â–µ—Å—Ç–≤—É" onchange="updateMultiSummary('answers')">–ø–æ —Å—É—â–µ—Å—Ç–≤—É</label>
                        <label class="checkbox-item"><input type="checkbox" name="answers" value="—Å–∫—É–ø–æ" onchange="updateMultiSummary('answers')">—Å–∫—É–ø–æ</label>
                        <label class="checkbox-item"><input type="checkbox" name="answers" value="—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ" onchange="updateMultiSummary('answers')">—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ</label>
                        <label class="checkbox-item"><input type="checkbox" name="answers" value="—É–∫–ª–æ–Ω—á–∏–≤–æ" onchange="updateMultiSummary('answers')">—É–∫–ª–æ–Ω—á–∏–≤–æ</label>
                    </div>
                </div>

                <label>–†–µ—á—å:</label>
                <select id="speech">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è</option>
                    <option>—É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è</option>
                    <option>–∑–∞–º–µ–¥–ª–µ–Ω–Ω–∞—è</option>
                    <option>—Å–∫–∞–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</option>
                    <option>–º–æ–Ω–æ–ª–æ–≥–∏—á–Ω–∞—è</option>
                    <option>–∂–∞—Ä–≥–æ–Ω</option>
                    <option>–º–æ–Ω–æ—Ç–æ–Ω–Ω–∞—è</option>
                </select>
            </div>

            

    <div id="status-thinking" class="status-subsection">
                <h3>üí≠ –ú—ã—à–ª–µ–Ω–∏–µ</h3>
                <div class="subgroup-grid">
                    <div>
                        <label>–¢–µ–º–ø –º—ã—à–ª–µ–Ω–∏—è:</label>
                        <select id="thinking_tempo">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–Ω–µ –Ω–∞—Ä—É—à–µ–Ω</option>
                            <option>–∑–∞–º–µ–¥–ª–µ–Ω</option>
                            <option>—É—Å–∫–æ—Ä–µ–Ω</option>
                        </select>
                    </div>
                    <div>
                        <label>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è:</label>
                        <select id="thinking_productivity">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞</option>
                            <option>–ø–æ–≤—ã—à–µ–Ω–∞</option>
                            <option>—Å–Ω–∏–∂–µ–Ω–∞</option>
                            <option>–Ω–µ—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ–µ</option>
                        </select>
                    </div>
                    <div>
                        <label>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è:</label>
                        <select id="thinking_sequence">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–Ω–µ –Ω–∞—Ä—É—à–µ–Ω–∞</option>
                            <option>–Ω–∞—Ä—É—à–µ–Ω–∞</option>
                        </select>
                    </div>
                    <div>
                        <label>–¶–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è:</label>
                        <select id="thinking_goal">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>—Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ</option>
                            <option>–Ω–µ—Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ</option>
                        </select>
                    </div>
                </div>

                <div class="multicheck-group" data-name="thinking_disorders">
                    <div class="multicheck-header" onclick="toggleMultiGroup('thinking_disorders')">
                        <span class="multicheck-label">–ù–µ—Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="thinking_disorders_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="thinking_disorders_body">
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="–ø–∞—Ä–∞–ª–æ–≥–∏—á–Ω–æ–µ" onchange="updateMultiSummary('thinking_disorders')">–ø–∞—Ä–∞–ª–æ–≥–∏—á–Ω–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="—Å–æ—Å–∫–∞–ª—å–∑—ã–≤–∞—é—â–µ–µ" onchange="updateMultiSummary('thinking_disorders')">—Å–æ—Å–∫–∞–ª—å–∑—ã–≤–∞—é—â–µ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="—Ä–µ–∑–æ–Ω–µ—Ä—Å—Ç–≤–æ" onchange="updateMultiSummary('thinking_disorders')">—Ä–µ–∑–æ–Ω–µ—Ä—Å—Ç–≤–æ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="—Ä–∞–∑–æ—Ä–≤–∞–Ω–Ω–æ–µ" onchange="updateMultiSummary('thinking_disorders')">—Ä–∞–∑–æ—Ä–≤–∞–Ω–Ω–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="–±–µ—Å—Å–≤—è–∑–Ω–æ–µ" onchange="updateMultiSummary('thinking_disorders')">–±–µ—Å—Å–≤—è–∑–Ω–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_disorders" value="–∞–º–æ—Ä—Ñ–Ω–æ–µ" onchange="updateMultiSummary('thinking_disorders')">–∞–º–æ—Ä—Ñ–Ω–æ–µ</label>
                    </div>
                </div>

                <div class="multicheck-group" data-name="thinking_mobility">
                    <div class="multicheck-header" onclick="toggleMultiGroup('thinking_mobility')">
                        <span class="multicheck-label">–ü–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è</span>
                        <span class="multicheck-summary" id="thinking_mobility_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="thinking_mobility_body">
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="–Ω–µ –Ω–∞—Ä—É—à–µ–Ω–∞" onchange="updateMultiSummary('thinking_mobility')">–Ω–µ –Ω–∞—Ä—É—à–µ–Ω–∞</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="–æ–±—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ" onchange="updateMultiSummary('thinking_mobility')">–æ–±—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="—Ä–∏–≥–∏–¥–Ω–æ–µ" onchange="updateMultiSummary('thinking_mobility')">—Ä–∏–≥–∏–¥–Ω–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="–≤—è–∑–∫–æ–µ" onchange="updateMultiSummary('thinking_mobility')">–≤—è–∑–∫–æ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="–∑–∞—Å—Ç—Ä–µ–≤–∞—é—â–µ–µ" onchange="updateMultiSummary('thinking_mobility')">–∑–∞—Å—Ç—Ä–µ–≤–∞—é—â–µ–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="thinking_mobility" value="–∏–Ω–µ—Ä—Ç–Ω–æ–µ" onchange="updateMultiSummary('thinking_mobility')">–∏–Ω–µ—Ä—Ç–Ω–æ–µ</label>
                    </div>
                </div>

                <label>–ê–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:</label>
                <select id="abstraction">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–¥–æ—Å—Ç—É–ø–Ω–æ</option>
                    <option>–æ–±–æ–±—â–µ–Ω–∏–µ –ø–æ –æ–±—â–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º</option>
                    <option>–æ–±–æ–±—â–µ–Ω–∏–µ –ø–æ –ª–∞—Ç–µ–Ω—Ç–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º</option>
                    <option>–∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ</option>
                    <option>–º—ã—à–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ</option>
                </select>

                <div id="ideas-block" class="status-subsection" style="margin-top: 12px;">
                    <h3>–ò–¥–µ–∏</h3>
                    <div class="subgroup-grid">
                        <div class="idea-row">
                            <label class="checkbox-item">
                                <input type="checkbox" class="idea-checkbox" data-idea-type="–∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω—ã–µ">
                                <span>–ê—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω—ã–µ</span>
                            </label>
                            <input type="text" class="idea-description" data-idea-type="–∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω—ã–µ" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏–¥–µ–π">
                        </div>
                        <div class="idea-row">
                            <label class="checkbox-item">
                                <input type="checkbox" class="idea-checkbox" data-idea-type="–Ω–∞–≤—è–∑—á–∏–≤—ã–µ">
                                <span>–ù–∞–≤—è–∑—á–∏–≤—ã–µ</span>
                            </label>
                            <input type="text" class="idea-description" data-idea-type="–Ω–∞–≤—è–∑—á–∏–≤—ã–µ" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏–¥–µ–π">
                        </div>
                        <div class="idea-row">
                            <label class="checkbox-item">
                                <input type="checkbox" class="idea-checkbox" data-idea-type="—Å–≤–µ—Ä—Ö—Ü–µ–Ω–Ω—ã–µ">
                                <span>–°–≤–µ—Ä—Ö—Ü–µ–Ω–Ω—ã–µ</span>
                            </label>
                            <input type="text" class="idea-description" data-idea-type="—Å–≤–µ—Ä—Ö—Ü–µ–Ω–Ω—ã–µ" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏–¥–µ–π">
                        </div>
                        <div class="idea-row">
                            <label class="checkbox-item">
                                <input type="checkbox" class="idea-checkbox" data-idea-type="–±—Ä–µ–¥–æ–≤—ã–µ">
                                <span>–ë—Ä–µ–¥–æ–≤—ã–µ</span>
                            </label>
                            <input type="text" class="idea-description" data-idea-type="–±—Ä–µ–¥–æ–≤—ã–µ" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏–¥–µ–π">
                        </div>
                    </div>
                </div>
            </div>

            

    <div id="status-intellect" class="status-subsection">
                <h3>üìö –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç</h3>
                <div class="subgroup-grid">
                    <div>
                        <label>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç:</label>
                        <select id="intellect">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –Ω–æ—Ä–º—ã</option>
                            <option>—Å–Ω–∏–∂–µ–Ω</option>
                            <option>–Ω–µ —Ä–∞–∑–≤–∏—Ç</option>
                        </select>
                    </div>
                    <div>
                        <label>–°–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å:</label>
                        <select id="vocabulary">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω</option>
                            <option>–æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ-–±—ã—Ç–æ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è</option>
                            <option>–∫—Ä–∞–π–Ω–µ –º–∞–ª</option>
                        </select>
                    </div>
                </div>
                <div class="multicheck-group" data-name="judgment">
                    <div class="multicheck-header" onclick="toggleMultiGroup('judgment')">
                        <span class="multicheck-label">–°—É–∂–¥–µ–Ω–∏—è (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="judgment_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="judgment_body">
                        <label class="checkbox-item"><input type="checkbox" name="judgment" value="–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ" onchange="updateMultiSummary('judgment')">–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="judgment" value="–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ" onchange="updateMultiSummary('judgment')">–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="judgment" value="–∫–∞—Ç–µ–≥–æ—Ä–∏—á–Ω—ã–µ" onchange="updateMultiSummary('judgment')">–∫–∞—Ç–µ–≥–æ—Ä–∏—á–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="judgment" value="–Ω–µ–∑—Ä–µ–ª—ã–µ" onchange="updateMultiSummary('judgment')">–Ω–µ–∑—Ä–µ–ª—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="judgment" value="–∑—Ä–µ–ª—ã–µ" onchange="updateMultiSummary('judgment')">–∑—Ä–µ–ª—ã–µ</label>
                    </div>
                </div>
            </div>

            <!-- === –û–ë–ù–û–í–õ–Å–ù–ù–´–ô –ë–õ–û–ö ¬´–û–ë–ú–ê–ù–´ –í–û–°–ü–†–ò–Ø–¢–ò–Ø¬ª === -->
            

    <div id="status-perception" class="status-subsection">
                <h3>üëÅÔ∏è –û–±–º–∞–Ω—ã –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è</h3>

                <!-- –ò–ª–ª—é–∑–∏–∏ -->
                <details class="perception-group" id="illusions_group">
                    <summary class="perception-summary">–ò–ª–ª—é–∑–∏–∏</summary>
                    <div class="perception-inner">
                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="illusion-checkbox" data-illusion-type="–§–∏–∑–∏—á–µ—Å–∫–∏–µ">
                                <span>–§–∏–∑–∏—á–µ—Å–∫–∏–µ</span>
                            </label>
                            <input type="text"
                                   class="perception-description illusion-description"
                                   data-illusion-type="–§–∏–∑–∏—á–µ—Å–∫–∏–µ"
                                   placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)">
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="illusion-checkbox" data-illusion-type="–ê—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ">
                                <span>–ê—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ</span>
                            </label>
                            <input type="text"
                                   class="perception-description illusion-description"
                                   data-illusion-type="–ê—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ"
                                   placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="illusion-checkbox" data-illusion-type="–í–µ—Ä–±–∞–ª—å–Ω—ã–µ (—Å–º—ã—Å–ª–æ–≤—ã–µ)">
                                <span>–í–µ—Ä–±–∞–ª—å–Ω—ã–µ (—Å–º—ã—Å–ª–æ–≤—ã–µ)</span>
                            </label>
                            <input type="text"
                                   class="perception-description illusion-description"
                                   data-illusion-type="–í–µ—Ä–±–∞–ª—å–Ω—ã–µ (—Å–º—ã—Å–ª–æ–≤—ã–µ)"
                                   placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="illusion-checkbox" data-illusion-type="–ü–∞—Ä–µ–π–¥–æ–ª–∏—á–µ—Å–∫–∏–µ">
                                <span>–ü–∞—Ä–µ–π–¥–æ–ª–∏—á–µ—Å–∫–∏–µ</span>
                            </label>
                            <input type="text"
                                   class="perception-description illusion-description"
                                   data-illusion-type="–ü–∞—Ä–µ–π–¥–æ–ª–∏—á–µ—Å–∫–∏–µ"
                                   placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">
                        </div>
                    </div>
                </details>

                <!-- –ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏ -->
                <details class="perception-group" id="hallucinations_group">
                    <summary class="perception-summary">–ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏</summary>
                    <div class="perception-inner">
                        <div class="perception-columns-analyzer">
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="—Å–ª—É—Ö–æ–≤—ã–µ">
                                –°–ª—É—Ö–æ–≤—ã–µ
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ">
                                –ó—Ä–∏—Ç–µ–ª—å–Ω—ã–µ
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="–æ–±–æ–Ω—è—Ç–µ–ª—å–Ω—ã–µ">
                                –û–±–æ–Ω—è—Ç–µ–ª—å–Ω—ã–µ
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="–≤–∫—É—Å–æ–≤—ã–µ">
                                –í–∫—É—Å–æ–≤—ã–µ
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="—Ç–∞–∫—Ç–∏–ª—å–Ω—ã–µ">
                                –¢–∞–∫—Ç–∏–ª—å–Ω—ã–µ
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="hallucination_analyzer" value="–≤–∏—Å—Ü–µ—Ä–∞–ª—å–Ω—ã–µ">
                                –í–∏—Å—Ü–µ—Ä–∞–ª—å–Ω—ã–µ
                            </label>
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="hall-type-checkbox" data-hall-type="–ò—Å—Ç–∏–Ω–Ω—ã–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏">
                                <span>–ò—Å—Ç–∏–Ω–Ω—ã–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏</span>
                            </label>
                            <input type="text"
                                   class="perception-description hall-type-description"
                                   data-hall-type="–ò—Å—Ç–∏–Ω–Ω—ã–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏"
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å–ª—É—Ö–æ–≤—ã–µ –≥–æ–ª–æ—Å–∞ –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É—é—â–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞">
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="hall-type-checkbox" data-hall-type="–ü—Å–µ–≤–¥–æ–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏">
                                <span>–ü—Å–µ–≤–¥–æ–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏</span>
                            </label>
                            <input type="text"
                                   class="perception-description hall-type-description"
                                   data-hall-type="–ü—Å–µ–≤–¥–æ–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏"
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ¬´–≥–æ–ª–æ—Å–∞ –≤ –≥–æ–ª–æ–≤–µ¬ª">
                        </div>

                        <div class="perception-row-inline">
                            <label class="checkbox-item">
                                <input type="checkbox" class="hall-type-checkbox" data-hall-type="–ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ç–æ—Ä–Ω–æ-–ø–æ–¥–æ–±–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è">
                                <span>–ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ç–æ—Ä–Ω–æ-–ø–æ–¥–æ–±–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è</span>
                            </label>
                            <input type="text"
                                   class="perception-description hall-type-description"
                                   data-hall-type="–ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ç–æ—Ä–Ω–æ-–ø–æ–¥–æ–±–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è"
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —è—Ä–∫–∏–µ, –Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –æ—Å–æ–∑–Ω–∞–≤–∞–µ–º—ã–µ –æ–±—Ä–∞–∑—ã">
                        </div>
                    </div>
                </details>

                <!-- –ü—Å–∏—Ö–æ—Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
                <details class="perception-group" id="psychosensory_group">
                    <summary class="perception-summary">–ü—Å–∏—Ö–æ—Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</summary>
                    <div class="perception-inner">
                        <div class="psychosensory-columns">
                            <div>
                                <div class="group-title">–î–µ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ</div>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="psychosensory_derealization"
                                           value="–∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏">
                                    –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="psychosensory_derealization"
                                           value="–∏—Å–∫–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ (–º–∞–∫—Ä–æ-/–º–∏–∫—Ä–æ–ø—Å–∏—è)">
                                    –ò—Å–∫–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ (–º–∞–∫—Ä–æ-/–º–∏–∫—Ä–æ–ø—Å–∏—è)
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="psychosensory_derealization"
                                           value="–∏—Å–∫–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã (–¥–∏—Å–º–æ—Ä—Ñ–æ–ø—Å–∏—è)">
                                    –ò—Å–∫–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã (–¥–∏—Å–º–æ—Ä—Ñ–æ–ø—Å–∏—è)
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="psychosensory_derealization"
                                           value="–∏—Å–∫–∞–∂–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è/–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã">
                                    –ò—Å–∫–∞–∂–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è/–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
                                </label>
                            </div>
                            <div>
                                <div class="group-title">–ê—É—Ç–æ–ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ</div>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="psychosensory_autopsychic"
                                           value="–¥–µ–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ¬´–Ø¬ª)">
                                    –î–µ–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ¬´–Ø¬ª)
                                </label>
                            </div>
                        </div>
                        <div class="perception-row">
                            <input type="text"
                                   id="psychosensory_description"
                                   class="perception-description"
                                   placeholder="–°–≤–æ–±–æ–¥–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Å–∏—Ö–æ—Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤">
                        </div>
                    </div>
                </details>

                <!-- –ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º—ã -->
                <details class="perception-group" id="psychic_automatism_group">
                    <summary class="perception-summary">–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º—ã</summary>
                    <div class="perception-inner">
                        <div class="perception-columns">
                            <label class="checkbox-item">
                                <input type="checkbox" name="psychic_automatism" value="—Å–µ–Ω—Å–æ—Ä–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º">
                                –°–µ–Ω—Å–æ—Ä–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="psychic_automatism" value="–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º">
                                –ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" name="psychic_automatism"
                                       value="–∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π (–¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω—ã–π) –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º">
                                –ö–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π (–¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω—ã–π) –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º
                            </label>
                        </div>
                        <div class="perception-row">
                            <input type="text"
                                   id="psychic_automatism_description"
                                   class="perception-description"
                                   placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –≤–ª–∏—è–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π –Ω–∞ –º—ã—Å–ª–∏ —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫—É)">
                        </div>
                    </div>
                </details>

                <label style="margin-top: 12px;">–û–±–º–∞–Ω—ã –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è (—Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç):</label>
                <textarea id="perception_hallucinations">–í–æ –≤—Ä–µ–º—è –ø—Ä–∏–µ–º–∞ –æ–±–º–∞–Ω—ã –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –Ω–µ –≤—ã—è–≤–ª—è–µ—Ç</textarea>

            </div>



            

    <div id="status-memory" class="status-subsection">
                <h3>üß© –ü–∞–º—è—Ç—å</h3>
                <div class="multicheck-group" data-name="memory">
                    <div class="multicheck-header" onclick="toggleMultiGroup('memory')">
                        <span class="multicheck-label">–ü–∞–º—è—Ç—å (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="memory_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="memory_body">
                        <label class="checkbox-item"><input type="checkbox" name="memory" value="–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –Ω–æ—Ä–º—ã" onchange="updateMultiSummary('memory')">–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –Ω–æ—Ä–º—ã</label>
                        <label class="checkbox-item"><input type="checkbox" name="memory" value="—Å–Ω–∏–∂–µ–Ω–∞" onchange="updateMultiSummary('memory')">—Å–Ω–∏–∂–µ–Ω–∞</label>
                        <label class="checkbox-item"><input type="checkbox" name="memory" value="–≥–∏–ø–æ–º–Ω–µ–∑–∏—è" onchange="updateMultiSummary('memory')">–≥–∏–ø–æ–º–Ω–µ–∑–∏—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="memory" value="–∞–º–Ω–µ–∑–∏—è" onchange="updateMultiSummary('memory')">–∞–º–Ω–µ–∑–∏—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="memory" value="–ø–∞—Ä–∞–º–Ω–µ–∑–∏–∏" onchange="updateMultiSummary('memory')">–ø–∞—Ä–∞–º–Ω–µ–∑–∏–∏</label>
                    </div>
                </div>

                <div class="multicheck-group" data-name="amnesia">
                    <div class="multicheck-header" onclick="toggleMultiGroup('amnesia')">
                        <span class="multicheck-label">–ê–º–Ω–µ–∑–∏—è (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="amnesia_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="amnesia_body">
                        <label class="checkbox-item"><input type="checkbox" name="amnesia" value="—Ñ–∏–∫—Å–∞—Ü–∏–æ–Ω–Ω–∞—è" onchange="updateMultiSummary('amnesia')">—Ñ–∏–∫—Å–∞—Ü–∏–æ–Ω–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="amnesia" value="–∞–Ω—Ç–µ—Ä–æ–≥—Ä–∞–¥–Ω–∞—è" onchange="updateMultiSummary('amnesia')">–∞–Ω—Ç–µ—Ä–æ–≥—Ä–∞–¥–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="amnesia" value="—Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–∞—è" onchange="updateMultiSummary('amnesia')">—Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="amnesia" value="–∞–Ω—Ç–µ—Ä–æ—Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–∞—è" onchange="updateMultiSummary('amnesia')">–∞–Ω—Ç–µ—Ä–æ—Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–∞—è</label>
                        <label class="checkbox-item"><input type="checkbox" name="amnesia" value="–∫–æ–Ω–≥—Ä–∞–¥–Ω–∞—è" onchange="updateMultiSummary('amnesia')">–∫–æ–Ω–≥—Ä–∞–¥–Ω–∞—è</label>
                    </div>
                </div>

                <div class="multicheck-group" data-name="paramnesia">
                    <div class="multicheck-header" onclick="toggleMultiGroup('paramnesia')">
                        <span class="multicheck-label">–ü–∞—Ä–∞–º–Ω–µ–∑–∏–∏ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="paramnesia_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="paramnesia_body">
                        <label class="checkbox-item"><input type="checkbox" name="paramnesia" value="–∫–æ–Ω—Ñ–∞–±—É–ª—è—Ü–∏–∏" onchange="updateMultiSummary('paramnesia')">–∫–æ–Ω—Ñ–∞–±—É–ª—è—Ü–∏–∏</label>
                        <label class="checkbox-item"><input type="checkbox" name="paramnesia" value="–ø—Å–µ–≤–¥–æ—Ä–µ–º–∏–Ω–∏—Å—Ü–µ–Ω—Ü–∏–∏" onchange="updateMultiSummary('paramnesia')">–ø—Å–µ–≤–¥–æ—Ä–µ–º–∏–Ω–∏—Å—Ü–µ–Ω—Ü–∏–∏</label>
                    </div>
                </div>
            </div>

            

    <div id="status-attention" class="status-subsection">
                <h3>üéØ –í–Ω–∏–º–∞–Ω–∏–µ</h3>
                <div class="multicheck-group" data-name="attention">
                    <div class="multicheck-header" onclick="toggleMultiGroup('attention')">
                        <span class="multicheck-label">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)</span>
                        <span class="multicheck-summary" id="attention_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="attention_body">
                        <div class="attention-group">
                            <div class="group-title">–ì–∏–ø–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è</div>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ (—Ä–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å)" onchange="updateMultiSummary('attention')">—Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ (—Ä–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å)</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–∏—Å—Ç–æ—â–∞–µ–º–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">–∏—Å—Ç–æ—â–∞–µ–º–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–∑–∞–º–µ–¥–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">–∑–∞–º–µ–¥–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è</label>
                        </div>
                        <div class="attention-group">
                            <div class="group-title">–ì–∏–ø–µ—Ä–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è</div>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –æ—Ç–≤–ª–µ–∫–∞–µ–º–æ—Å—Ç—å / –≥–∏–ø–µ—Ä–ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –æ—Ç–≤–ª–µ–∫–∞–µ–º–æ—Å—Ç—å / –≥–∏–ø–µ—Ä–ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è</label>
                        </div>
                        <div class="attention-group">
                            <div class="group-title">–ù–∞—Ä—É—à–µ–Ω–∏—è –æ–±—ä—ë–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è</div>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Å—É–∂–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">—Å—É–∂–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è</label>
                        </div>
                        <div class="attention-group">
                            <div class="group-title">–ù–∞—Ä—É—à–µ–Ω–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º–æ—Å—Ç–∏</div>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Ç—Ä—É–¥–Ω–æ—Å—Ç—å —Å–º–µ–Ω—ã —Ñ–æ–∫—É—Å–∞" onchange="updateMultiSummary('attention')">—Ç—Ä—É–¥–Ω–æ—Å—Ç—å —Å–º–µ–Ω—ã —Ñ–æ–∫—É—Å–∞</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–ª–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è" onchange="updateMultiSummary('attention')">–ª–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è</label>
                        </div>
                        <div class="attention-group">
                            <div class="group-title">–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è</div>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏—è</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ)" onchange="updateMultiSummary('attention')">–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ)</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Ä–∏–≥–∏–¥–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è" onchange="updateMultiSummary('attention')">—Ä–∏–≥–∏–¥–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è</label>
                            <label class="checkbox-item"><input type="checkbox" name="attention" value="—Å–≤–µ—Ä—Ö–≤–Ω–∏–º–∞–Ω–∏–µ (–≥–∏–ø–µ—Ä—Ñ–∏–∫—Å–∞—Ü–∏—è)" onchange="updateMultiSummary('attention')">—Å–≤–µ—Ä—Ö–≤–Ω–∏–º–∞–Ω–∏–µ (–≥–∏–ø–µ—Ä—Ñ–∏–∫—Å–∞—Ü–∏—è)</label>
                        </div>
                    </div>
                </div>
            </div>

            

    <div id="status-mood" class="status-subsection">
                <h3>üôÇ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</h3>
                <div class="subgroup-grid">
                    <div>
                        <label>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</label>
                        <select id="mood">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>—Ä–æ–≤–Ω–æ–µ</option>
                            <option>—Å–Ω–∏–∂–µ–Ω–Ω–æ–µ</option>
                            <option>–ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ</option>
                        </select>
                    </div>
                    <div>
                        <label>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ ‚Äî —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:</label>
                        <select id="emotions_stability">
                            <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                            <option>—É—Å—Ç–æ–π—á–∏–≤—ã–µ</option>
                            <option>–Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã–µ</option>
                        </select>
                    </div>
                </div>

                <div class="multicheck-group" data-name="emotions">
                    <div class="multicheck-header" onclick="toggleMultiGroup('emotions')">
                        <span class="multicheck-label">–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="emotions_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="emotions_body">
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–∂–∏–≤—ã–µ" onchange="updateMultiSummary('emotions')">–∂–∏–≤—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="—É–ø–ª–æ—â–µ–Ω–Ω—ã–µ" onchange="updateMultiSummary('emotions')">—É–ø–ª–æ—â–µ–Ω–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–≤—ã—Ö–æ–ª–æ—â–µ–Ω–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–≤—ã—Ö–æ–ª–æ—â–µ–Ω–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–æ–≥—Ä—É–±–ª–µ–Ω–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–æ–≥—Ä—É–±–ª–µ–Ω–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="—Ç—É—Å–∫–ª—ã–µ" onchange="updateMultiSummary('emotions')">—Ç—É—Å–∫–ª—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–æ–¥–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–æ–¥–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–º–æ–Ω–æ—Ç–æ–Ω–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–º–æ–Ω–æ—Ç–æ–Ω–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ" onchange="updateMultiSummary('emotions')">–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º —Ç—Ä–µ–≤–æ–≥–∏" onchange="updateMultiSummary('emotions')">—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º —Ç—Ä–µ–≤–æ–≥–∏</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º –¥–µ–ø—Ä–µ—Å—Å–∏–∏" onchange="updateMultiSummary('emotions')">—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º –¥–µ–ø—Ä–µ—Å—Å–∏–∏</label>
                        <label class="checkbox-item"><input type="checkbox" name="emotions" value="—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" onchange="updateMultiSummary('emotions')">—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
                        <!-- ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã ... -->
                        <label class="checkbox-item">
                            <input
                                type="checkbox"
                                name="emotions"
                                value="D_OTHER"
                                onchange="toggleOtherField('emotions')"
                            >
                            –¥—Ä—É–≥–æ–µ
                        </label>
                        <input
                            type="text"
                            id="emotions_other"
                            maxlength="100"
                            placeholder="—É—Ç–æ—á–Ω–∏—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é"
                            oninput="updateMultiSummary('emotions')"
                            style="display:none"
                        >
                    </div>
                </div>

                <label>–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏:</label>
                <select id="aggression">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</option>
                    <option>–≤ –∞–¥—Ä–µ—Å –æ–∫—Ä—É–∂–∞—é—â–∏—Ö</option>
                    <option>–≤ –∞–¥—Ä–µ—Å —Å–µ–±—è (–∞—É—Ç–æ–∞–≥—Ä–µ—Å—Å–∏—è)</option>
                </select>

                <label>–°—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Å–º–æ—Ç—Ä–∞:</label>
                <select id="suicidal_thoughts">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</option>
                    <option>–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç</option>
                </select>

                <label>–°—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Å–º–æ—Ç—Ä–∞:</label>
                <select id="suicidal_plans">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</option>
                    <option>–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç</option>
                </select>

                <label>–°—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ:</label>
                <div class="suicide-history" id="suicide_history_block">
                    <label class="checkbox-item">
                        <input type="checkbox" name="suicide_history" value="none" id="suicide_history_none">
                        –Ω–µ –æ—Ç–º–µ—á–∞–µ—Ç
                    </label>

                    <label class="checkbox-item">
                        <input type="checkbox" name="suicide_history" value="attempts" id="suicide_history_attempts">
                        –±—ã–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ —Å—É–∏—Ü–∏–¥–∞
                        <input
                            type="text"
                            id="suicide_attempts_times"
                            class="suicide-inline-input"
                            maxlength="5"
                            placeholder="–º–Ω–æ–≥–æ/3/10+"
                            disabled
                        >
                        <span>—Ä–∞–∑</span>
                    </label>

                    <label class="checkbox-item">
                        <input type="checkbox" name="suicide_history" value="nssi" id="suicide_history_nssi">
                        —Å–∞–º–æ–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –±–µ–∑ —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–≥–æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
                        <input
                            type="text"
                            id="suicide_nssi_times"
                            class="suicide-inline-input"
                            maxlength="5"
                            placeholder="–Ω–µ—Å–∫–æ–ª—å–∫–æ"
                            disabled
                        >
                        <span>—Ä–∞–∑</span>
                    </label>

                    <label class="checkbox-item">
                        <input type="checkbox" name="suicide_history" value="uncertain" id="suicide_history_uncertain">
                        –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å
                    </label>
                </div>

                <label for="suicide_last_description" id="suicide_last_description_label" style="display: none;">
                    –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ø–∏–∑–æ–¥–∞:
                </label>
                <input
                    type="text"
                    id="suicide_last_description"
                    style="display: none;"
                    placeholder="–ö—Ä–∞—Ç–∫–æ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç–ø–∏–∑–æ–¥–µ (—á—Ç–æ –¥–µ–ª–∞–ª, –∫–æ–≥–¥–∞, –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è)"
                >




                <label>–ö–æ–Ω—Ç—Ä—Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:</label>
                <textarea id="contrsuicidal_factors" placeholder="—Å–µ–º—å—è, –¥–µ—Ç–∏, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ —É–±–µ–∂–¥–µ–Ω–∏—è –∏ –¥—Ä."></textarea>
            </div>

            

    <div id="status-motor" class="status-subsection">
                <h3>üèÉ –î–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞</h3>
                <label>–í–æ–ª–µ–≤—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞:</label>
                <select id="will">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</option>
                    <option>—Å–Ω–∏–∂–µ–Ω—ã</option>
                    <option>–Ω–µ —Ä–∞–∑–≤–∏—Ç—ã</option>
                </select>

                <label>–î–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞:</label>
                <textarea id="motor" placeholder="–∑–∞–º–µ–¥–ª–µ–Ω–Ω–∞—è/—É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –º–æ—Ç–æ—Ä–∏–∫–∞, –∫–∞—Ç–∞—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã –∏ –¥—Ä."></textarea>

                <label>–≠–ø–∏–ª–µ–ø—Ç–∏—Ñ–æ—Ä–º–Ω—ã–µ –ø–∞—Ä–æ–∫—Å–∏–∑–º—ã:</label>
                <select id="seizures">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–æ—Ç—Ä–∏—Ü–∞–µ—Ç</option>
                    <option>–æ—Ç–º–µ—á–∞–ª–∏—Å—å –≤ –ø—Ä–æ—à–ª–æ–º</option>
                    <option>–Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è</option>
                </select>
            </div>

            

    <div id="status-insight" class="status-subsection">
                <h3>üîç –ö—Ä–∏—Ç–∏–∫–∞ –∫ —Å–≤–æ–µ–º—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—é</h3>
                <label>–ß—É–≤—Å—Ç–≤–æ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏:</label>
                <select id="distance">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>—Å–æ–±–ª—é–¥–∞–µ—Ç</option>
                    <option>—Å–Ω–∏–∂–µ–Ω–æ</option>
                    <option>–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</option>
                </select>

                <label>–ö—Ä–∏—Ç–∏–∫–∞ –∫ —Å–≤–æ–µ–º—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—é:</label>
                <select id="insight">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–µ—Å—Ç—å</option>
                    <option>—á–∞—Å—Ç–∏—á–Ω–∞—è</option>
                    <option>–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</option>
                </select>

                <label>–ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ:</label>
                <textarea id="future_plans"></textarea>
            </div>

            

    <div id="status-sleep-appetite" class="status-subsection">
                <h3>üåô –°–æ–Ω, üçé –∞–ø–ø–µ—Ç–∏—Ç</h3>
                <div class="multicheck-group" data-name="sleep">
                    <div class="multicheck-header" onclick="toggleMultiGroup('sleep')">
                        <span class="multicheck-label">–°–æ–Ω (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</span>
                        <span class="multicheck-summary" id="sleep_summary">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                    </div>
                    <div class="multicheck-body" id="sleep_body">
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π" onchange="updateMultiSummary('sleep')">—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π" onchange="updateMultiSummary('sleep')">–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="–ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞—Å—ã–ø–∞–Ω–∏–µ–º (>30 –º–∏–Ω—É—Ç)" onchange="updateMultiSummary('sleep')">–ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞—Å—ã–ø–∞–Ω–∏–µ–º (&gt;30 –º–∏–Ω—É—Ç)</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="—á–∞—Å—Ç—ã–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –Ω–æ—á—å—é (> 3 –∑–∞ –Ω–æ—á—å)" onchange="updateMultiSummary('sleep')">—á–∞—Å—Ç—ã–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –Ω–æ—á—å—é (&gt; 3 –∑–∞ –Ω–æ—á—å)</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="—Ä–∞–Ω–Ω–µ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ" onchange="updateMultiSummary('sleep')">—Ä–∞–Ω–Ω–µ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="–æ—Ç—Å—É—Ç—Å–≤–∏–µ —á—É–≤—Å—Ç–≤–∞ –æ—Ç–¥—ã—Ö–∞ –ø–æ—Å–ª–µ —Å–Ω–∞" onchange="updateMultiSummary('sleep')">–æ—Ç—Å—É—Ç—Å–≤–∏–µ —á—É–≤—Å—Ç–≤–∞ –æ—Ç–¥—ã—Ö–∞ –ø–æ—Å–ª–µ —Å–Ω–∞</label>
                        <label class="checkbox-item"><input type="checkbox" name="sleep" value="–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" onchange="updateMultiSummary('sleep')">–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</label>
                    </div>
                </div>

                <label>–ê–ø–ø–µ—Ç–∏—Ç:</label>
                <select id="appetite">
                    <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
                    <option>–≤ –Ω–æ—Ä–º–µ</option>
                    <option>—Å–Ω–∏–∂–µ–Ω</option>
                    <option>–ø–æ–≤—ã—à–µ–Ω</option>
                    <option>–∞–Ω–æ—Ä–µ–∫—Å–∏—è</option>
                    <option>–±—É–ª–∏–º–∏—è</option>
                </select>
            </div>

<!-- –î–ò–ê–ì–ù–û–ó, –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò, –ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø -->

        

</div>


      <!-- –î–∏–∞–≥–Ω–æ–∑, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç -->
      <!-- =============================== -->
<!--   –ë–õ–û–ö –î–ò–ê–ì–ù–û–ó–ê                 -->
<!-- =============================== -->

<div class="section" id="section-diagnosis">
    <h2 class="section-title">ü©∫ –î–∏–∞–≥–Ω–æ–∑</h2>
    <div class="section-card">
        <label for="icd_search">–ü–æ–∏—Å–∫ –¥–∏–∞–≥–Ω–æ–∑–∞ –ø–æ –ú–ö–ë-10:</label>
        <input id="icd_search"
               type="text"
               placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å..."
               oninput="searchICD()">

        <div id="icd_results" class="icd-results"></div>

        <label for="diagnosis">–î–∏–∞–≥–Ω–æ–∑ (—à–∏—Ñ—Ä—ã –ú–ö–ë-10):</label>
        <textarea id="diagnosis"></textarea>
    </div>

</div>

      <div class="section" id="section-recommendations">
    <h2>üñãÔ∏èÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>

     <div class="section-card">
        <div class="library-top">
            <div class="small-note">
                –û—Ç–º–µ—Ç—å—Ç–µ –Ω—É–∂–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç
                <b>¬´–ö–æ—Ä–æ—Ç–∫–æ¬ª</b> –∏–ª–∏ <b>¬´–ü–æ–ª–Ω–æ¬ª</b> ‚Äî —Ç–µ–∫—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–∏–∂–µ.
            </div>

            <div class="selected-count">
                –í—ã–±—Ä–∞–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
                <span id="recommendations-selected-count">0</span>
            </div>
        </div>
        <div id="group-filters" class="group-filters"></div>

        <!-- –°–Æ–î–ê JS –†–ò–°–£–ï–¢ –ö–ê–†–¢–û–ß–ö–ò -->
        <div class="rec-grid" id="recommendation-cards"></div>

        <div class="library-footer">
            <button type="button" id="collect-recommendations-button">
                –°–æ–±—Ä–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤ –ø–æ–ª–µ –Ω–∏–∂–µ
            </button>
        </div>

        <label for="recommendations">–ò—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:</label>
        <textarea id="recommendations"></textarea>
    </div>
</div>

      <div class="section" id="section-prescriptions">
    <h2>‚Ñû –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è</h2>

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è / —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è -->
    <div class="prescription-editor" id="prescription-editor">
        <div class="prescription-editor-row">
            <div class="prescription-field">
                <label class="prescription-label-small" for="rx-name">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞</label>
                <input
                    type="text"
                    id="rx-name"
                    class="rx-input-wide"
                    placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –°–µ—Ä—Ç—Ä–∞–ª–∏–Ω"
                    autocomplete="off"
                >
            </div>

            <div class="prescription-field prescription-field-inline">
                <span class="prescription-label-small">–í —Ç–µ—á–µ–Ω–∏–µ</span>
                <div class="rx-duration-row">
                    <select id="rx-duration-value">
                        <option value="">‚Äî</option>
                        <!-- 1‚Äì30 -->
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                    </select>

                    <label class="rx-duration-type">
                        <input type="radio" name="rx-duration-type" value="days" checked>
                        –¥–Ω–µ–π
                    </label>
                    <label class="rx-duration-type">
                        <input type="radio" name="rx-duration-type" value="months">
                        –º–µ—Å—è—Ü–µ–≤
                    </label>
                </div>
            </div>
        </div>

        <div class="prescription-editor-row">
            <div class="prescription-field full-width">
                <span class="prescription-label-small">–°—Ö–µ–º–∞ –ø—Ä–∏—ë–º–∞ –∏ –¥–æ–∑–∞ (–º–≥)</span>
                <div class="rx-times-grid">
                    <div class="rx-time-cell">
                        <label class="rx-time-label">
                            <input
                                type="checkbox"
                                class="rx-time-checkbox"
                                data-time="—É—Ç—Ä–æ–º"
                            >
                            –£—Ç—Ä–æ–º
                        </label>
                        <input
                            type="number"
                            class="rx-dose-input"
                            data-time="—É—Ç—Ä–æ–º"
                            placeholder="–º–≥"
                            min="0"
                            step="1"
                            disabled
                        >
                    </div>

                    <div class="rx-time-cell">
                        <label class="rx-time-label">
                            <input
                                type="checkbox"
                                class="rx-time-checkbox"
                                data-time="–¥–Ω—ë–º"
                            >
                            –î–Ω—ë–º
                        </label>
                        <input
                            type="number"
                            class="rx-dose-input"
                            data-time="–¥–Ω—ë–º"
                            placeholder="–º–≥"
                            min="0"
                            step="1"
                            disabled
                        >
                    </div>

                    <div class="rx-time-cell">
                        <label class="rx-time-label">
                            <input
                                type="checkbox"
                                class="rx-time-checkbox"
                                data-time="–≤–µ—á–µ—Ä–æ–º"
                            >
                            –í–µ—á–µ—Ä–æ–º
                        </label>
                        <input
                            type="number"
                            class="rx-dose-input"
                            data-time="–≤–µ—á–µ—Ä–æ–º"
                            placeholder="–º–≥"
                            min="0"
                            step="1"
                            disabled
                        >
                    </div>

                    <div class="rx-time-cell">
                        <label class="rx-time-label">
                            <input
                                type="checkbox"
                                class="rx-time-checkbox"
                                data-time="–Ω–∞ –Ω–æ—á—å"
                            >
                            –ù–∞ –Ω–æ—á—å
                        </label>
                        <input
                            type="number"
                            class="rx-dose-input"
                            data-time="–Ω–∞ –Ω–æ—á—å"
                            placeholder="–º–≥"
                            min="0"
                            step="1"
                            disabled
                        >
                    </div>
                </div>
            </div>
        </div>

        <div class="prescription-editor-row">
            <div class="prescription-field full-width">
                <label class="prescription-label-small" for="rx-comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                <textarea
                    id="rx-comment"
                    rows="2"
                    class="rx-textarea"
                    placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ—Å–ª–µ –µ–¥—ã"
                ></textarea>
            </div>
        </div>

        <div class="prescription-editor-actions">
            <button type="button" class="btn-secondary" id="rx-clear-btn">
                –û—á–∏—Å—Ç–∏—Ç—å
            </button>
            <button type="button" class="btn-primary" id="rx-submit-btn">
                –î–æ–±–∞–≤–∏—Ç—å
            </button>
        </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π -->
    <div class="prescriptions-list-header">
        –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
    </div>
    <div id="prescriptions_list" class="prescriptions-list">
        <div class="prescriptions-empty">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π.</div>
    </div>
</div>

      <div class="buttons">
    <button type="button" onclick="generateText()">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
    <button type="button" class="btn-secondary" onclick="copyResult()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
</div>

<div class="section" id="section-result">
    <h2>–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</h2>
    <div id="result-container">
        <div id="result" contenteditable="true"></div>
    </div>
</div>


    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∏ –∏ –Ω–∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <footer style="
    width: 100%;
    padding: 14px 0;
    margin-top: 26px;
    text-align: center;
    font-size: 13px;
    color: #666;
    line-height: 1.4;
">
  <div>Psychstatus ‚Ä¢ –º–æ–¥—É–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω</div>
  <div>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: –£–±–µ–π–∫–æ–Ω—å –î–º–∏—Ç—Ä–∏–π</div>

  <div style="margin-top: 6px;">
    <a href="https://t.me/Dmitrii_Ubeikon" target="_blank"
       style="color: inherit; text-decoration: none; display: inline-flex; align-items: center; gap: 4px;">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="#0088cc" xmlns="http://www.w3.org/2000/svg">
        <path d="M9.99995 15.1999L9.89995 19.2999C10.2999 19.2999 10.4999 19.0999 10.6999 18.8999L12.6999 16.9999L16.6999 20.0999C17.3999 20.4999 17.8999 20.2999 18.0999 19.3999L21.8999 2.89993C22.1999 1.79993 21.4999 1.29993 20.7999 1.59993L2.99995 8.49993C1.89995 8.89993 1.89995 9.49993 2.79995 9.79993L7.39995 11.1999L17.6999 5.19993C18.1999 4.89993 18.6999 5.09993 18.2999 5.39993L9.99995 15.1999Z"/>
      </svg>
      @Dmitrii_Ubeikon
    </a>
  </div>

  <div style="margin-top: 10px; font-size: 9px; color: #888; max-width: 750px; margin-left:auto; margin-right:auto;">
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è –æ–∑–Ω–∞—á–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏.
    –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª.
    –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
    –ù–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —É—Å–ª—É–≥–æ–π –∏–ª–∏ –∑–∞–º–µ–Ω–æ–π –æ—á–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
    –õ–∏—Ü–µ–Ω–∑–∏—è: —Å–≤–æ–±–æ–¥–Ω–æ–µ –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∞.
  </div>
</footer>

  <!-- TODO: modals -->


  <script>
    // TODO: DOM helpers

    // TODO: text helpers


    const FORM_SCHEMA = {};

    const DEFAULT_STATE = {};

    function loadState() {
    return null;
}

function saveState(state) {
    return state;
}


    function toggleSidebar() {
    document.body.classList.toggle('sidebar-collapsed');
}

function initSidebar() {
    const links = document.querySelectorAll('.sidebar-link');
    if (!links.length) return;

    links.forEach((link) => {
        link.addEventListener('click', () => {
            // —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö
            links.forEach((l) => l.classList.remove('sidebar-link--active'));
            // —Å—Ç–∞–≤–∏–º –Ω–∞ –∫–ª–∏–∫–Ω—É—Ç—ã–π
            link.classList.add('sidebar-link--active');
        });
    });
}

document.addEventListener('DOMContentLoaded', initSidebar);

    function toggleMultiGroup(name) {
    const body = document.getElementById(name + '_body');
    if (!body) return;
    body.classList.toggle('open');
}

/**
 * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ summary –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –º—É–ª—å—Ç–∏—á–µ–∫—Å–∞.
 * –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç "–¥—Ä—É–≥–æ–µ":
 *  - —á–µ–∫–±–æ–∫—Å —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º D_OTHER / –î–†–£–ì–û–ï
 *  - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Å id="<name>_other"
 */
function updateMultiSummary(name) {
    const summary = document.getElementById(name + '_summary');
    if (!summary) return;

    const checked = document.querySelectorAll('input[type="checkbox"][name="' + name + '"]:checked');
    const parts = [];

    checked.forEach(cb => {
        if (cb.value !== 'D_OTHER' && cb.value !== '–î–†–£–ì–û–ï') {
            parts.push(cb.value);
        }
    });

    const otherCheckbox = document.querySelector(
    `input[type="checkbox"][name="${name}"][value="D_OTHER"]`
    );
    const otherField = document.getElementById(name + '_other');

    if (otherCheckbox && otherCheckbox.checked && otherField) {
        const txt = otherField.value.trim();
        if (txt) parts.push(txt);
    }

    summary.textContent = parts.length ? parts.join(', ') : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
}

function toggleOtherField(name) {
    const otherCheckbox = document.querySelector(`input[name="${name}"][value="D_OTHER"]`);
    const otherField = document.getElementById(name + '_other');

    if (!otherCheckbox || !otherField) return;

    if (otherCheckbox.checked) {
        otherField.style.display = 'block';
    } else {
        otherField.style.display = 'none';
        otherField.value = '';
    }

    updateMultiSummary(name);
}


/**
 * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–±–æ—Ä —Ç–µ–∫—Å—Ç–∞ –¥–ª—è builder.js.
 * –õ–æ–≥–∏–∫–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å updateMultiSummary:
 *  - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–∞–º –º–∞—Ä–∫–µ—Ä "–¥—Ä—É–≥–æ–µ" (D_OTHER/–î–†–£–ì–û–ï)
 *  - –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ "<name>_other", –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å.
 */
function getCheckedTextByName(name) {
    const checked = document.querySelectorAll('input[type="checkbox"][name="' + name + '"]:checked');
    const parts = [];

    checked.forEach(cb => {
        if (cb.value !== 'D_OTHER' && cb.value !== '–î–†–£–ì–û–ï') {
            parts.push(cb.value);
        }
    });

    const otherCheckbox = document.querySelector(
        `input[type="checkbox"][name="${name}"][value="D_OTHER"]`
    );
    const otherField = document.getElementById(name + '_other');

    if (otherCheckbox && otherCheckbox.checked && otherField) {
        const txt = otherField.value.trim();
        if (txt) parts.push(txt);
    }

    return parts.join(', ');
}

// –§—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –≤ "–í–Ω–µ—à–Ω–∏–π –≤–∏–¥"
function toggleAppearanceOther(cb) {
    const field = document.getElementById('appearance_other');
    field.style.display = cb.checked ? 'block' : 'none';
    if (!cb.checked) field.value = "";
}

function updateAppearance() {
    const checkboxes = document.querySelectorAll('input[name="appearance"]:checked');
    const parts = [];

    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫—Ä–æ–º–µ —Å–∞–º–æ–≥–æ —Å–ª–æ–≤–∞ "–¥—Ä—É–≥–æ–µ"
    checkboxes.forEach(cb => {
        if (cb.value !== "–î–†–£–ì–û–ï" && cb.value !== "D_OTHER") {
            parts.push(cb.value);
        }
    });

    // –ï—Å–ª–∏ –≤ –ø–æ–ª–µ "–¥—Ä—É–≥–æ–µ" —á—Ç–æ-—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º —ç—Ç–æ –∫–∞–∫ —Ç–µ–∫—Å—Ç
    const otherField = document.getElementById('appearance_other');
    if (otherField && otherField.value.trim() !== "") {
        parts.push(otherField.value.trim());
    }

    // –ü–∏—à–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è builder.js
    const hidden = document.getElementById('appearance');
    if (hidden) {
        hidden.value = parts.join(', ');
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º summary –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    const summary = document.getElementById('appearance_summary');
    if (summary) {
        summary.innerText = parts.length ? parts.join(', ') : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
    }
}

// ==========================
// –°—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ
// ==========================

function initSuicideHistory() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"][name="suicide_history"]');
    if (!checkboxes.length) return;

    const noneCb      = document.getElementById('suicide_history_none');
    const uncertainCb = document.getElementById('suicide_history_uncertain');
    const attemptsCb  = document.getElementById('suicide_history_attempts');
    const nssiCb      = document.getElementById('suicide_history_nssi');

    const attemptsInput = document.getElementById('suicide_attempts_times');
    const nssiInput     = document.getElementById('suicide_nssi_times');

    const lastLabel = document.getElementById('suicide_last_description_label');
    const lastInput = document.getElementById('suicide_last_description');

    function updateSuicideHistoryState(changedCb) {
        // –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å "–Ω–µ –æ—Ç–º–µ—á–∞–µ—Ç"
        if (noneCb && changedCb === noneCb && noneCb.checked) {
            checkboxes.forEach(cb => {
                if (cb !== noneCb) cb.checked = false;
            });
        }

        // –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å "–∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å"
        if (uncertainCb && changedCb === uncertainCb && uncertainCb.checked) {
            checkboxes.forEach(cb => {
                if (cb !== uncertainCb) cb.checked = false;
            });
        }

        // –ï—Å–ª–∏ –æ—Ç–º–µ—Ç–∏–ª–∏ –ø–æ–ø—ã—Ç–∫–∏/–ù–°–° ‚Äî —Å–Ω–∏–º–∞–µ–º "–Ω–µ –æ—Ç–º–µ—á–∞–µ—Ç" –∏ "–∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç—Å—è"
        const attemptsChecked = attemptsCb && attemptsCb.checked;
        const nssiChecked     = nssiCb && nssiCb.checked;

        if (attemptsChecked || nssiChecked) {
            if (noneCb) noneCb.checked = false;
            if (uncertainCb) uncertainCb.checked = false;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è–º–∏ "—Ä–∞–∑"
        if (attemptsInput) {
            attemptsInput.disabled = !attemptsChecked;
            if (!attemptsChecked) attemptsInput.value = '';
        }

        if (nssiInput) {
            nssiInput.disabled = !nssiChecked;
            if (!nssiChecked) nssiInput.value = '';
        }

        // –ü–æ–∫–∞–∑ / —Å–∫—Ä—ã—Ç–∏–µ "–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ø–∏–∑–æ–¥–∞"
        const showLast = attemptsChecked || nssiChecked;

        if (lastLabel && lastInput) {
            lastLabel.style.display = showLast ? '' : 'none';
            lastInput.style.display = showLast ? '' : 'none';

            if (!showLast) {
                lastInput.value = '';
            }
        }
    }

    checkboxes.forEach(cb => {
        cb.addEventListener('change', function () {
            updateSuicideHistoryState(cb);
        });
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    updateSuicideHistoryState(null);
}

document.addEventListener('DOMContentLoaded', function () {
    // ...–µ—Å–ª–∏ —Ç—É—Ç —É–∂–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ init-—Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –µ—â—ë –æ–¥–Ω—É
    initSuicideHistory();
});

    document.addEventListener('DOMContentLoaded', () => {
    const links = document.querySelectorAll('.sidebar-link');

    links.forEach(link => {
        link.addEventListener('click', () => {
            links.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
        });
    });
});

        function collectCheckboxDescriptions(selector) {
        const items = [];
        document.querySelectorAll(selector).forEach(cb => {
            if (cb.checked) {
                const type = cb.dataset.perceptionType;
                const descInput = document.querySelector('.perception-description[data-perception-type="' + type + '"]');
                const desc = descInput ? descInput.value.trim() : '';
                items.push({ type, desc });
            }
        });
        return items;
    }

    function collectIllusionsText() {
        const illusions = [];
        document.querySelectorAll('.illusion-checkbox').forEach(cb => {
            if (cb.checked) {
                const type = cb.dataset.illusionType;
                const descInput = document.querySelector(
                    '.illusion-description[data-illusion-type="' + type + '"]'
                );
                const desc = descInput ? descInput.value.trim() : '';
                illusions.push(desc ? type + ' ‚Äî ' + desc : type);
            }
        });
        return illusions;
    }

    function collectHallucinationText() {
        const analyzer = getCheckedTextByName('hallucination_analyzer');

        const hallTypes = [];
        document.querySelectorAll('.hall-type-checkbox').forEach(cb => {
            if (cb.checked) {
                const type = cb.dataset.hallType;
                const descInput = document.querySelector(
                    '.hall-type-description[data-hall-type="' + type + '"]'
                );
                const desc = descInput ? descInput.value.trim() : '';
                hallTypes.push(desc ? type + ' ‚Äî ' + desc : type);
            }
        });

        const parts = [];
        if (analyzer) parts.push('–ø–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—É: ' + analyzer);
        if (hallTypes.length) parts.push(hallTypes.join('; '));

        return parts.length ? '–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏ (' + parts.join('; ') + ')' : '';
    }

    function collectPerceptionText() {
        const parts = [];

        // –ò–ª–ª—é–∑–∏–∏
        const illusions = collectIllusionsText();
        if (illusions.length) {
            parts.push('–∏–ª–ª—é–∑–∏–∏: ' + illusions.join('; '));
        }

        // –ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏
        const hallucinations = collectHallucinationText();
        if (hallucinations) {
            parts.push(hallucinations);
        }

        // –ü—Å–∏—Ö–æ—Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        const dereal = getCheckedTextByName('psychosensory_derealization');
        const autopsych = getCheckedTextByName('psychosensory_autopsychic');
        const psychoDesc = document.getElementById('psychosensory_description')?.value.trim();
        if (dereal || autopsych || psychoDesc) {
            const psParts = [];
            if (dereal) psParts.push('–¥–µ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ ‚Äî ' + dereal);
            if (autopsych) psParts.push('–∞—É—Ç–æ–ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ ‚Äî ' + autopsych);
            if (psychoDesc) psParts.push(psychoDesc);
            parts.push('–ø—Å–∏—Ö–æ—Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ' + psParts.join('; '));
        }

        // –ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º—ã
        const automatismTypes = getCheckedTextByName('psychic_automatism');
        const automatismDesc = document.getElementById('psychic_automatism_description')?.value.trim();
        if (automatismTypes || automatismDesc) {
            let line = '–ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º—ã: ';
            if (automatismTypes) line += automatismTypes;
            if (automatismDesc) line += (automatismTypes ? '; ' : '') + automatismDesc;
            parts.push(line);
        }

        // –°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        const freeTextEl =
            document.getElementById('perception_hallucinations')
            ?? document.getElementById('perception');
        const freeText = freeTextEl?.value.trim();
        if (freeText) {
            parts.push(freeText);
        }

        return parts.join('; ');
    }

        function collectIdeasText() {
        const items = [];
        document.querySelectorAll('.idea-checkbox').forEach(cb => {
            if (cb.checked) {
                const type = cb.dataset.ideaType;
                const descInput = document.querySelector('.idea-description[data-idea-type="' + type + '"]');
                const desc = descInput ? descInput.value.trim() : '';
                items.push(desc ? `${type} ‚Äî ${desc}` : type);
            }
        });
        return items.join('; ');
    }


        // –ù–µ–±–æ–ª—å—à–æ–π —Å–ø–∏—Å–æ–∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä—É–±—Ä–∏–∫ –ú–ö–ë-10 (–º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å)
    const icd10 = [
        { code: 'F10.2', name: '–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –∞–ª–∫–æ–≥–æ–ª—è, —Å–∏–Ω–¥—Ä–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏' },
        { code: 'F11.2', name: '–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –æ–ø–∏–æ–∏–¥–æ–≤, —Å–∏–Ω–¥—Ä–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏' },

        { code: 'F20.0', name: '–®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è –ø–∞—Ä–∞–Ω–æ–∏–¥–Ω–∞—è' },
        { code: 'F20.1', name: '–®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è –≥–µ–±–µ—Ñ—Ä–µ–Ω–∏—á–µ—Å–∫–∞—è' },
        { code: 'F20.3', name: '–®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è –Ω–µ–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è' },
        { code: 'F20.6', name: '–®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–∞—è' },
        { code: 'F21',   name: '–®–∏–∑–æ—Ç–∏–ø–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' },
        { code: 'F22.0', name: '–•—Ä–æ–Ω–∏—á–µ—Å–∫–æ–µ –±—Ä–µ–¥–æ–≤–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' },
        { code: 'F23.1', name: '–û—Å—Ç—Ä—ã–π –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–π –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏–π —ç–ø–∏–∑–æ–¥ —Å —Å–∏–º–ø—Ç–æ–º–∞–º–∏ —à–∏–∑–æ—Ñ—Ä–µ–Ω–∏–∏' },
        { code: 'F25.0', name: '–®–∏–∑–æ–∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –º–∞–Ω–∏–∞–∫–∞–ª—å–Ω—ã–π —Ç–∏–ø' },
        { code: 'F25.1', name: '–®–∏–∑–æ–∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ç–∏–ø' },

        { code: 'F31.0', name: '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ –∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ –≥–∏–ø–æ–º–∞–Ω–∏–∏' },
        { code: 'F31.1', name: '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ –∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ –º–∞–Ω–∏–∏ –±–µ–∑ –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤' },
        { code: 'F31.2', name: '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ –∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ –º–∞–Ω–∏–∏ —Å –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–∏–º–ø—Ç–æ–º–∞–º–∏' },
        { code: 'F31.3', name: '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ –∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ —É–º–µ—Ä–µ–Ω–Ω–æ–π –∏–ª–∏ –ª—ë–≥–∫–æ–π –¥–µ–ø—Ä–µ—Å—Å–∏–∏' },
        { code: 'F31.4', name: '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ –∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ —Ç—è–∂—ë–ª–æ–π –¥–µ–ø—Ä–µ—Å—Å–∏–∏ –±–µ–∑ –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤' },

        { code: 'F32.0', name: '–î–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π —ç–ø–∏–∑–æ–¥ –ª—ë–≥–∫–æ–π —Å—Ç–µ–ø–µ–Ω–∏' },
        { code: 'F32.1', name: '–î–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π —ç–ø–∏–∑–æ–¥ —Å—Ä–µ–¥–Ω–µ–π —Å—Ç–µ–ø–µ–Ω–∏' },
        { code: 'F32.2', name: '–î–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π —ç–ø–∏–∑–æ–¥ —Ç—è–∂—ë–ª–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –±–µ–∑ –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤' },
        { code: 'F32.3', name: '–î–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π —ç–ø–∏–∑–æ–¥ —Ç—è–∂—ë–ª–æ–π —Å—Ç–µ–ø–µ–Ω–∏ —Å –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–∏–º–ø—Ç–æ–º–∞–º–∏' },
        { code: 'F33.0', name: '–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ –ª—ë–≥–∫–æ–π —Å—Ç–µ–ø–µ–Ω–∏' },
        { code: 'F33.1', name: '–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ —Å—Ä–µ–¥–Ω–µ–π —Å—Ç–µ–ø–µ–Ω–∏' },
        { code: 'F33.2', name: '–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Ç–µ–∫—É—â–∏–π —ç–ø–∏–∑–æ–¥ —Ç—è–∂—ë–ª–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –±–µ–∑ –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤' },

        { code: 'F40.0', name: '–ê–≥–æ—Ä–∞—Ñ–æ–±–∏—è' },
        { code: 'F40.1', name: '–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ–±–∏–∏' },
        { code: 'F41.0', name: '–ü–∞–Ω–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (—ç–ø–∏–∑–æ–¥–∏—á–µ—Å–∫–∞—è –ø–∞—Ä–æ–∫—Å–∏–∑–º–∞–ª—å–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞)' },
        { code: 'F41.1', name: '–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ç—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' },
        { code: 'F41.2', name: '–°–º–µ—à–∞–Ω–Ω–æ–µ —Ç—Ä–µ–≤–æ–∂–Ω–æ–µ –∏ –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' },

        { code: 'F42.0', name: '–û–±—Å–µ—Å—Å–∏–≤–Ω–æ-–∫–æ–º–ø—É–ª—å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–≤—è–∑—á–∏–≤—ã–º–∏ –º—ã—Å–ª—è–º–∏ –∏–ª–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è–º–∏' },
        { code: 'F42.1', name: '–û–±—Å–µ—Å—Å–∏–≤–Ω–æ-–∫–æ–º–ø—É–ª—å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–º–ø—É–ª—å—Å–∏–≤–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (–Ω–∞–≤—è–∑—á–∏–≤—ã–µ —Ä–∏—Ç—É–∞–ª—ã)' },
        { code: 'F42.2', name: '–û–±—Å–µ—Å—Å–∏–≤–Ω–æ-–∫–æ–º–ø—É–ª—å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Å–º–µ—à–∞–Ω–Ω—ã–µ –Ω–∞–≤—è–∑—á–∏–≤—ã–µ –º—ã—Å–ª–∏ –∏ –¥–µ–π—Å—Ç–≤–∏—è' },

        { code: 'F43.1', name: '–ü–æ—Å—Ç—Ç—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ç—Ä–µ—Å—Å–æ–≤–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' },
        { code: 'F43.2', name: '–†–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏' },

        { code: 'F60.3', name: '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ª–∏—á–Ω–æ—Å—Ç–∏ (–≤ —Ç. —á. –ø–æ–≥—Ä–∞–Ω–∏—á–Ω–æ–µ)' },
        { code: 'F84.0', name: '–ê—É—Ç–∏–∑–º –¥–µ—Ç—Å–∫–∏–π' }
        // —Å—é–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ –∫–æ–¥—ã
    ];

    function searchICD() {
        const query = document.getElementById('icd_search').value.trim().toLowerCase();
        const resultsDiv = document.getElementById('icd_results');
        resultsDiv.innerHTML = '';

        if (query.length < 2) {
            return;
        }

        const matches = icd10.filter(item =>
            item.code.toLowerCase().includes(query) ||
            item.name.toLowerCase().includes(query)
        ).slice(0, 30);

        if (matches.length === 0) {
            const empty = document.createElement('div');
            empty.className = 'icd-item';
            empty.textContent = '–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ';
            resultsDiv.appendChild(empty);
            return;
        }

        matches.forEach(item => {
            const div = document.createElement('div');
            div.className = 'icd-item';
            div.textContent = item.code + ' ‚Äî ' + item.name;

            div.onclick = function () {
                const diag = document.getElementById('diagnosis');
                const line = item.code + ' ' + item.name;

                if (diag.value && !diag.value.endsWith('\n')) {
                    diag.value += '\n';
                }
                if (!diag.value.includes(line)) {
                    diag.value += line;
                }
            };

            resultsDiv.appendChild(div);
        });
    }

    /* –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ï –ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø */




        const RECOMMENDATIONS_LIBRARY = [
        {
            id: 'rec_sleep_schedule',
            group: 'general',
            title: '–†–µ–∂–∏–º —Å–Ω–∞ –∏ –±–æ–¥—Ä—Å—Ç–≤–æ–≤–∞–Ω–∏—è',
            short: '–°–æ–±–ª—é–¥–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π —Ä–µ–∂–∏–º —Å–Ω–∞',
            full: '–°–æ–±–ª—é–¥–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π —Ä–µ–∂–∏–º —Å–Ω–∞ –∏ –±–æ–¥—Ä—Å—Ç–≤–æ–≤–∞–Ω–∏—è: —É–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è –∏ –ø—Ä–æ—Å—ã–ø–∞—Ç—å—Å—è –≤ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è, –∏–∑–±–µ–≥–∞—Ç—å –¥–Ω–µ–≤–Ω–æ–≥–æ —Å–Ω–∞ –±–æ–ª–µ–µ 30 –º–∏–Ω—É—Ç, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–∞–¥–∂–µ—Ç–æ–≤ –∑–∞ 1‚Äì2 —á–∞—Å–∞ –¥–æ —Å–Ω–∞, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø–æ–∫–æ–π–Ω—ã–π —Ä–∏—Ç—É–∞–ª –∑–∞—Å—ã–ø–∞–Ω–∏—è.'
        },
        {
            id: 'rec_activity',
            group: 'general',
            title: '–£–º–µ—Ä–µ–Ω–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            short: '–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —É–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            full: '–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è —É–º–µ—Ä–µ–Ω–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ –º–µ–Ω–µ–µ 30 –º–∏–Ω—É—Ç –≤ –¥–µ–Ω—å (—Ö–æ–¥—å–±–∞, –õ–§–ö, —Ä–∞—Å—Ç—è–∂–∫–∞, –ø–ª–∞–≤–∞–Ω–∏–µ) —Å —É—á—ë—Ç–æ–º —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.'
        },
        {
            id: 'rec_caffeine_limit',
            group: 'general',
            title: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ—Ñ–µ–∏–Ω–∞',
            short: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ—Ñ–µ–∏–Ω –ø–æ—Å–ª–µ 14:00',
            full: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∫–æ—Ñ–µ, —á–∞—è, —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –¥–Ω—è, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –º–æ–≥—É—Ç —É—Å–∏–ª–∏–≤–∞—Ç—å —Ç—Ä–µ–≤–æ–≥—É –∏ –Ω–∞—Ä—É—à–∞—Ç—å —Å–æ–Ω.'
        },
        {
            id: 'rec_no_alcohol',
            group: 'general',
            title: '–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∞–ª–∫–æ–≥–æ–ª—è –∏ –ü–ê–í',
            short: '–ò—Å–∫–ª—é—á–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å –∏ –ü–ê–í',
            full: '–ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∏—Ç—å —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∞–ª–∫–æ–≥–æ–ª—è –∏ –Ω–µ–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø—Å–∏—Ö–æ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —É—Ö—É–¥—à–∞—é—Ç —Ç–µ—á–µ–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏ —Å–Ω–∏–∂–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏.'
        },
        {
            id: 'rec_med_adherence',
            group: 'general',
            title: '–°–æ–±–ª—é–¥–µ–Ω–∏–µ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–æ–∑–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏',
            short: '–ü—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –ø–æ —Å—Ö–µ–º–µ',
            full: '–ü—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã —Å—Ç—Ä–æ–≥–æ –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π —Å—Ö–µ–º–µ, –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –¥–æ–∑–∏—Ä–æ–≤–∫—É –∏ –Ω–µ –æ—Ç–º–µ–Ω—è—Ç—å –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–µ –ø—Ä–µ–∫—Ä–∞—â–∞—Ç—å –ø—Ä–∏—ë–º, –∞ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –≤—Ä–∞—á—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ —Ç–µ—Ä–∞–ø–∏–∏.'
        },
        {
            id: 'rec_psychiatrist_followup',
            group: 'general',
            title: '–ù–∞–±–ª—é–¥–µ–Ω–∏–µ —É –ø—Å–∏—Ö–∏–∞—Ç—Ä–∞',
            short: '–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ —É –ø—Å–∏—Ö–∏–∞—Ç—Ä–∞',
            full: '–†–µ–≥—É–ª—è—Ä–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å—Å—è —É –ø—Å–∏—Ö–∏–∞—Ç—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–∏–Ω–∞–º–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏ —Ç–µ—Ä–∞–ø–∏–∏ –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ª–µ—á–µ–Ω–∏—è. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–∏–∑–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ ___ –¥–Ω–µ–π –∏–ª–∏ —Ä–∞–Ω—å—à–µ –ø—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.'
        },
        {
            id: 'rec_day_structure',
            group: 'general',
            title: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–Ω—è',
            short: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω—å –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            full: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω—å: –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–∏–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —á–µ—Ä–µ–¥–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –∏ –æ—Ç–¥—ã—Ö, –∏–∑–±–µ–≥–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞—Å—Å–∏–≤–Ω–æ—Å—Ç–∏ –∏ —á—Ä–µ–∑–º–µ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–≥—Ä—É–∑–æ–∫.'
        },
        {
            id: 'rec_stress_management',
            group: 'general',
            title: '–†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º',
            short: '–û—Å–≤–∞–∏–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–µ—Å—Å–æ–º',
            full: '–û—Å–≤–∞–∏–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–µ—Å—Å–æ–º: –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –º—ã—à–µ—á–Ω–∞—è —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è, –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–≤–æ—Ü–∏—Ä—É—é—â–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.'
        },
        {
            id: 'rec_psychoeducation',
            group: 'general',
            title: '–ü—Å–∏—Ö–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',
            short: '–ü—Å–∏—Ö–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–∏ —Å–µ–º—å–∏)',
            full: '–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –ø—Å–∏—Ö–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏, –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–∏–∏, –µ–≥–æ –±–ª–∏–∑–∫–∏—Ö: –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–∏—Ä–æ–¥—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –≤–æ–∑–º–æ–∂–Ω–æ–π —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏–∫–∏, –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –ª–µ—á–µ–Ω–∏—è –∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –≤—Ä–∞—á—É.'
        },
        {
            id: 'rec_psychotherapy',
            group: 'general',
            title: '–ü—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—è',
            short: '–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—é',
            full: '–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∏–ª–∏ –≥—Ä—É–ø–ø–æ–≤–æ–π –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏–∏ (–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ-–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π –∏ –¥—Ä.) —Å —É—á—ë—Ç–æ–º –∑–∞–ø—Ä–æ—Å–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤.'
        },
        {
            id: 'rec_family_support',
            group: 'general',
            title: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–ª–∏–∑–∫–∏—Ö',
            short: '–ü—Ä–∏–≤–ª–µ—á—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–µ–º—å–∏',
            full: '–ü—Ä–∏–≤–ª–µ—á—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–µ–º—å–∏ –∏ –∑–Ω–∞—á–∏–º—ã—Ö –±–ª–∏–∑–∫–∏—Ö: –æ–±—Å—É–∂–¥–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–æ–≤–º–µ—Å—Ç–Ω–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–º–æ—â—å, –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –æ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —É—Ö—É–¥—à–µ–Ω–∏—è.'
        },
        {
            id: 'rec_crisis_plan',
            group: 'general',
            title: '–ö—Ä–∏–∑–∏—Å–Ω—ã–π –ø–ª–∞–Ω',
            short: '–°–æ—Å—Ç–∞–≤–∏—Ç—å –∫—Ä–∏–∑–∏—Å–Ω—ã–π –ø–ª–∞–Ω',
            full: '–°–æ—Å—Ç–∞–≤–∏—Ç—å –∫—Ä–∏–∑–∏—Å–Ω—ã–π –ø–ª–∞–Ω: –ø—Ä–∏ –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–º —É—Ö—É–¥—à–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —É—Å–∏–ª–µ–Ω–∏–∏ —Ç—Ä–µ–≤–æ–≥–∏ –∏–ª–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã—Ö –º—ã—Å–ª–µ–π –∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∑–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â—å—é (–∫ –¥–µ–∂—É—Ä–Ω–æ–º—É –ø—Å–∏—Ö–∏–∞—Ç—Ä—É, –≤ –ü–ù–î, –≤ —Å–ª—É–∂–±—É —Å–∫–æ—Ä–æ–π –ø–æ–º–æ—â–∏), –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–ª–∏–∑–∫–∏—Ö, –∏—Å–∫–ª—é—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–º –ø—Ä–µ–¥–º–µ—Ç–∞–º –∏ –≤–µ—â–µ—Å—Ç–≤–∞–º.'
        },
        {
            id: 'rec_self_monitoring',
            group: 'general',
            title: '–°–∞–º–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ',
            short: '–í–µ—Å—Ç–∏ –¥–Ω–µ–≤–Ω–∏–∫ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è',
            full: '–í–µ—Å—Ç–∏ –∫—Ä–∞—Ç–∫–∏–π –¥–Ω–µ–≤–Ω–∏–∫ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è: –æ—Ç–º–µ—á–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Ç—Ä–µ–≤–æ–≥—É, –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞, –ø—Ä–∏—ë–º –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ –∏ –∑–Ω–∞—á–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ –Ω–∞ –ø—Ä–∏—ë–º–µ.'
        },
        {
            id: 'rec_work_rest',
            group: 'general',
            title: '–†–µ–∂–∏–º —Ç—Ä—É–¥–∞ –∏ –æ—Ç–¥—ã—Ö–∞',
            short: '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞',
            full: '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Ç—Ä—É–¥–∞ –∏ –æ—Ç–¥—ã—Ö–∞: –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑–±–µ–≥–∞—Ç—å –Ω–æ—á–Ω—ã—Ö —Å–º–µ–Ω, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–æ–∫ –∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–¥–æ—Å—ã–ø–∞–Ω–∏—è; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Å—É–∂–¥–∞—Ç—å —Å —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏.'
        },
        {
            id: 'rec_anxiety_management',
            group: 'anxiety',
            title: '–†–∞–±–æ—Ç–∞ —Å —Ç—Ä–µ–≤–æ–≥–æ–π',
            short: '–û—Å–≤–∞–∏–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ —Å–Ω–∏–∂–µ–Ω–∏—è —Ç—Ä–µ–≤–æ–≥–∏',
            full: '–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –æ—Å–≤–æ–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫ —Å–Ω–∏–∂–µ–Ω–∏—è —Ç—Ä–µ–≤–æ–≥–∏: –º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ, –º—ã—à–µ—á–Ω–∞—è —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è, —Ç–µ—Ö–Ω–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è, –≤–µ–¥–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ —Ç—Ä–µ–≤–æ–≥–∏.'
        },
        {
            id: 'rec_stimulant_limit',
            group: 'anxiety',
            title: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä–æ–≤',
            short: '–°–æ–∫—Ä–∞—Ç–∏—Ç—å –∫–æ—Ñ–µ–∏–Ω –∏ –Ω–∏–∫–æ—Ç–∏–Ω',
            full: '–°–æ–∫—Ä–∞—Ç–∏—Ç—å —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∫–æ—Ñ–µ–∏–Ω–∞, –Ω–∏–∫–æ—Ç–∏–Ω–∞ –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä–æ–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç —É—Å–∏–ª–∏–≤–∞—Ç—å —Ç—Ä–µ–≤–æ–∂–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏ –Ω–∞—Ä—É—à–∞—Ç—å —Å–æ–Ω.'
        },
        {
            id: 'rec_activity_depression',
            group: 'depression',
            title: '–ü–æ–≤—ã—à–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
            short: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–º–µ—Ä–µ–Ω–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            full: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–º–µ—Ä–µ–Ω–Ω—É—é –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –≤–∫–ª—é—á–∞—Ç—å –ø–æ—Å–∏–ª—å–Ω—ã–µ –¥–µ–ª–∞, –ø—Ä–æ–≥—É–ª–∫–∏, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –∫—Ä—É–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å —É—á—ë—Ç–æ–º —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è.'
        },
        {
            id: 'rec_psychotherapy_depression',
            group: 'depression',
            title: '–ü—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—è –ø—Ä–∏ –¥–µ–ø—Ä–µ—Å—Å–∏–∏',
            short: '–ü—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—è –ø—Ä–∏ –¥–µ–ø—Ä–µ—Å—Å–∏–∏',
            full: '–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ-–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫—É—é –∏–ª–∏ –º–µ–∂–ª–∏—á–Ω–æ—Å—Ç–Ω—É—é –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º–∏ —É–±–µ–∂–¥–µ–Ω–∏—è–º–∏, —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –Ω–∞—Ä—É—à–µ–Ω–Ω–æ–π —Å–∞–º–æ–æ—Ü–µ–Ω–∫–æ–π.'
        },
        {
            id: 'rec_antipsychotic_control',
            group: 'psychosis',
            title: '–ö–æ–Ω—Ç—Ä–æ–ª—å –∞–Ω—Ç–∏–ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–æ–π —Ç–µ—Ä–∞–ø–∏–∏',
            short: '–ù–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∞–Ω—Ç–∏–ø—Å–∏—Ö–æ—Ç–∏–∫–∏',
            full: '–°—Ç—Ä–æ–≥–æ —Å–æ–±–ª—é–¥–∞—Ç—å –∞–Ω—Ç–∏–ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫—É—é —Ç–µ—Ä–∞–ø–∏—é: –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏—ë–º, –Ω–µ –º–µ–Ω—è—Ç—å –¥–æ–∑–∏—Ä–æ–≤–∫—É –∏ –Ω–µ –æ—Ç–º–µ–Ω—è—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.'
        },
        {
            id: 'rec_psychosis_safety',
            group: 'psychosis',
            title: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø—Å–∏—Ö–æ–∑–µ',
            short: '–°–æ–±–ª—é–¥–∞—Ç—å –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            full: '–ü—Ä–∏ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã—Ö –ø—Å–∏—Ö–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–ø—Ç–æ–º–∞—Ö –∏–∑–±–µ–≥–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º, —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ –∏ —Å–∏—Ç—É–∞—Ü–∏–π —Å –≤—ã—Å–æ–∫–∏–º —Ä–∏—Å–∫–æ–º —Ç—Ä–∞–≤–º.'
        },
        {
            id: 'rec_psychosis_support',
            group: 'psychosis',
            title: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–ª–∏–∑–∫–∏—Ö –ø—Ä–∏ –ø—Å–∏—Ö–æ–∑–µ',
            short: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–ª–∏–∑–∫–∏—Ö –æ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —É—Ö—É–¥—à–µ–Ω–∏—è',
            full: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–ª–∏–∑–∫–∏—Ö –æ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —É—Ö—É–¥—à–µ–Ω–∏—è (—É—Å–∏–ª–µ–Ω–∏–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π, –±—Ä–µ–¥–æ–≤—ã—Ö –∏–¥–µ–π, —Å–Ω–∏–∂–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏–∫–∏, –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ –≤–æ–∑–±—É–¥–∏–º–æ—Å—Ç–∏) –∏ –ø—Ä–æ—Å–∏—Ç—å –∏—Ö –æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–∏ –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞ –ø–æ–º–æ—â—å—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.'
        },
        {
            id: 'rec_sleep_hygiene',
            group: 'sleep',
            title: '–ì–∏–≥–∏–µ–Ω–∞ —Å–Ω–∞',
            short: '–ì–∏–≥–∏–µ–Ω–∞ —Å–Ω–∞',
            full: '–°–æ–±–ª—é–¥–∞—Ç—å –≥–∏–≥–∏–µ–Ω—É —Å–Ω–∞: –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤ –∑–∞ 1‚Äì2 —á–∞—Å–∞ –¥–æ —Å–Ω–∞, –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É, –∏–∑–±–µ–≥–∞—Ç—å —Ç—è–∂—ë–ª–æ–π –ø–∏—â–∏ –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–µ—á–µ—Ä–æ–º.'
        },
        {
            id: 'rec_day_sleep_limit',
            group: 'sleep',
            title: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–≥–æ —Å–Ω–∞',
            short: '–ò—Å–∫–ª—é—á–∏—Ç—å –¥–Ω–µ–≤–Ω–æ–π —Å–æ–Ω',
            full: '–ò–∑–±–µ–≥–∞—Ç—å –¥–Ω–µ–≤–Ω–æ–≥–æ —Å–Ω–∞ –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –µ–≥–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ 20‚Äì30 –º–∏–Ω—É—Ç, —á—Ç–æ–±—ã –Ω–µ —É—Ö—É–¥—à–∞—Ç—å –Ω–æ—á–Ω–æ–π —Å–æ–Ω.'
        },
        {
            id: 'rec_sleep_relaxation',
            group: 'sleep',
            title: '–†–µ–ª–∞–∫—Å–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —Å–Ω–æ–º',
            short: '–†–µ–ª–∞–∫—Å–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —Å–Ω–æ–º',
            full: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–Ω–æ–º —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã: –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –ª—ë–≥–∫—É—é —Ä–∞—Å—Ç—è–∂–∫—É, —Ç—ë–ø–ª—ã–π –¥—É—à –∏–ª–∏ –≤–∞–Ω–Ω—É.'
        },
        {
            id: 'rec_substance_stop',
            group: 'substance',
            title: '–û—Ç–∫–∞–∑ –æ—Ç –∞–ª–∫–æ–≥–æ–ª—è –∏ –ü–ê–í',
            short: '–ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ –æ—Ç –∞–ª–∫–æ–≥–æ–ª—è –∏ –ü–ê–í',
            full: '–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ –æ—Ç —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∞–ª–∫–æ–≥–æ–ª—è –∏ –Ω–µ–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø—Å–∏—Ö–æ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤; –ø—Ä–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è—Ö ‚Äî –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –Ω–∞—Ä–∫–æ–ª–æ–≥–∞ –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–ª—É–∂–±—ã.'
        },
        {
            id: 'rec_evening_plan',
            group: 'substance',
            title: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏',
            short: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–µ—á–µ—Ä–Ω–µ–µ –≤—Ä–µ–º—è',
            full: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Å–æ–±–µ–Ω–Ω–æ –≤–µ—á–µ—Ä–Ω–µ–µ –≤—Ä–µ–º—è, –∑–∞—Ä–∞–Ω–µ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–æ—Å—Ç—å, —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∞–ª–∫–æ–≥–æ–ª—è –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –≤–µ—â–µ—Å—Ç–≤.'
        },
        {
            id: 'rec_nutrition',
            group: 'extra',
            title: '–ü–∏—Ç–∞–Ω–∏–µ',
            short: '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ',
            full: '–°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ, –∏–∑–±–µ–≥–∞—Ç—å –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ –º–µ–∂–¥—É –ø—Ä–∏—ë–º–∞–º–∏ –ø–∏—â–∏ –∏ –ø–µ—Ä–µ–µ–¥–∞–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –≤–µ—á–µ—Ä–æ–º.'
        },
        {
            id: 'rec_screen_time',
            group: 'extra',
            title: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏',
            short: '–°–Ω–∏–∑–∏—Ç—å –≤—Ä–µ–º—è –∑–∞ —ç–∫—Ä–∞–Ω–∞–º–∏',
            full: '–ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–Ω–∏–∑–∏—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è –∑–∞ —ç–∫—Ä–∞–Ω–∞–º–∏ (—Ç–µ–ª–µ—Ñ–æ–Ω, –∫–æ–º–ø—å—é—Ç–µ—Ä, —Ç–µ–ª–µ–≤–∏–∑–æ—Ä), –æ—Å–æ–±–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ —Å–Ω–æ–º.'
        },
        {
            id: 'rec_social_activity',
            group: 'extra',
            title: '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            short: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã',
            full: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ—Å–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –æ–±—â–µ–Ω–∏—è —Å –±–ª–∏–∑–∫–∏–º–∏ –∏ –∑–Ω–∞–∫–æ–º—ã–º–∏, –∏–∑–±–µ–≥–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏.'
        }
    ];

// === –õ–û–ì–ò–ö–ê –ö–ê–†–¢–û–ß–ï–ö –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô ===


// –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –≥—Ä—É–ø–ø ‚Üí —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
const GROUP_LABELS = {
    general: "–û–±—â–∏–µ",
    sleep: "–°–æ–Ω",
    anxiety: "–¢—Ä–µ–≤–æ–≥–∞",
    depression: "–î–µ–ø—Ä–µ—Å—Å–∏—è",
    psychosis: "–ü—Å–∏—Ö–æ–∑",
    substance: "–ü–ê–í",
    extra: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ"
};
// –ü–æ—Ä—è–¥–æ–∫ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –≥—Ä—É–ø–ø

const GROUP_ORDER = [
    "general",
    "sleep",
    "anxiety",
    "depression",
    "psychosis",
    "substance",
    "extra"
];


// == –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∞ –≥—Ä—É–ø–ø ==

let activeGroup = 'sleep'; // "–°–æ–Ω" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

function getGroups() {
    const groupsSet = new Set();
    RECOMMENDATIONS_LIBRARY.forEach(item => {
        if (item.group) groupsSet.add(item.group);
    });

    const groups = Array.from(groupsSet);

    // —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞—à–µ–º—É –ø–æ—Ä—è–¥–∫—É
    groups.sort((a, b) => GROUP_ORDER.indexOf(a) - GROUP_ORDER.indexOf(b));

    return groups;
}

function renderGroupFilters() {
    const container = document.getElementById('group-filters');
    if (!container) return;

    const groups = getGroups();
    let html = '';

    // –ö–Ω–æ–ø–∫–∞ "–í—Å–µ"
    html += `
        <button 
            class="group-filter-btn ${activeGroup === 'all' ? 'active' : ''}" 
            data-group="all">
            –í—Å–µ
        </button>
    `;

    // –ö–Ω–æ–ø–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º
    groups.forEach(group => {
        const label = GROUP_LABELS[group] || group;
        html += `
          <button 
            class="group-filter-btn ${activeGroup === group ? 'active' : ''}" 
            data-group="${group}">
            ${label}
          </button>
        `;
    });

    container.innerHTML = html;

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –Ω—É–∂–Ω–æ, –∫–æ–ª–ª–µ–∫—Ü–∏—è –º–∞–ª–µ–Ω—å–∫–∞—è)
    container.querySelectorAll('.group-filter-btn').forEach((btn) => {
        btn.addEventListener('click', () => {
            activeGroup = btn.dataset.group;
            renderGroupFilters();    // –æ–±–Ω–æ–≤–ª—è–µ–º .active
            renderRecommendations(); // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ —Å —É—á—ë—Ç–æ–º —Ñ–∏–ª—å—Ç—Ä–∞
        });
    });
}

// == –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ ==

function getSortedFilteredRecommendations() {
    let items = RECOMMENDATIONS_LIBRARY.slice();

    // —Ñ–∏–ª—å—Ç—Ä –ø–æ –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø–µ
    if (activeGroup !== 'all') {
        items = items.filter((item) => item.group === activeGroup);
    }

    // —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Å–Ω–∞—á–∞–ª–∞ –ø–æ group, –ø–æ—Ç–æ–º –ø–æ title
    items.sort((a, b) => {
        if (a.group === b.group) {
            return (a.title || '').localeCompare(b.title || '', 'ru');
        }
        return (a.group || '').localeCompare(b.group || '', 'ru');
    });

    return items;
}

// == –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π ==

function renderRecommendations() {
    const container = document.getElementById('recommendation-cards');
    if (!container || !Array.isArray(RECOMMENDATIONS_LIBRARY)) return;

    container.innerHTML = '';

    const items = getSortedFilteredRecommendations();

    items.forEach((item) => {
        const card = document.createElement('div');
        card.className = 'rec-card';
        card.dataset.recId = item.id;
        card.dataset.mode = 'short';

        card.innerHTML = `
            <label class="rec-title">
                <input type="checkbox"
                       class="rec-toggle"
                       data-rec-id="${item.id}">
                <span>${item.title}</span>
            </label>

            <div class="rec-modes" data-rec-id="${item.id}">
                <label>
                    <input type="radio"
                           name="rec-${item.id}-mode"
                           value="short"
                           disabled>
                    –ö–æ—Ä–æ—Ç–∫–æ
                </label>
                <label>
                    <input type="radio"
                           name="rec-${item.id}-mode"
                           value="full"
                           disabled>
                    –ü–æ–ª–Ω–æ
                </label>
            </div>

            <div class="rec-text"
                 id="rec-text-${item.id}"
                 style="display:none;"></div>
        `;

        container.appendChild(card);
    });

    // –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
    updateSelectedCount();
}

// == –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–æ–¥–∏–Ω —Ä–∞–∑) ==

function initRecommendationCards() {
    const container = document.getElementById('recommendation-cards');
    if (!container || !Array.isArray(RECOMMENDATIONS_LIBRARY)) return;

    // –¥–µ–ª–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä —Å —É—á—ë—Ç–æ–º –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "all")
    renderRecommendations();

    // –æ–¥–∏–Ω —Ä–∞–∑ –≤–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
    container.addEventListener('change', onRecommendationCardsChange);
}

// == –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö ==

function onRecommendationCardsChange(event) {
    const target = event.target;
    if (!target) return;

    const card = target.closest('.rec-card');
    if (!card) return;

    const id = card.dataset.recId;
    const modesBlock = card.querySelector('.rec-modes');
    const textBlock = card.querySelector('.rec-text');
    if (!modesBlock || !textBlock) return;

    const radios = modesBlock.querySelectorAll('input[type="radio"]');

    // –∫–ª–∏–∫ –ø–æ —á–µ–∫–±–æ–∫—Å—É (–≤–∫–ª—é—á–µ–Ω–∏–µ / –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
    if (target.classList.contains('rec-toggle')) {
        if (target.checked) {
            radios.forEach((r) => { r.disabled = false; });

            let mode = card.dataset.mode || 'short';
            let radioToCheck =
                modesBlock.querySelector(`input[value="${mode}"]`) ||
                modesBlock.querySelector('input[value="short"]');

            if (radioToCheck) {
                radioToCheck.checked = true;
                mode = radioToCheck.value;
                card.dataset.mode = mode;
                setRecText(id, mode);
            }

            textBlock.style.display = 'block';
        } else {
            radios.forEach((r) => {
                r.disabled = true;
                r.checked = false;
            });
            textBlock.style.display = 'none';
            textBlock.textContent = '';
        }

        updateSelectedCount();
        return;
    }

    // –∫–ª–∏–∫ –ø–æ —Ä–∞–¥–∏–æ –ö–æ—Ä–æ—Ç–∫–æ/–ü–æ–ª–Ω–æ
    if (target.type === 'radio' &&
        target.name.startsWith('rec-') &&
        target.name.endsWith('-mode')) {

        const mode = target.value;
        card.dataset.mode = mode;
        setRecText(id, mode);
    }
}

// == –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ ==

function setRecText(id, mode) {
    const item = RECOMMENDATIONS_LIBRARY.find((r) => r.id === id);
    if (!item) return;

    const block = document.getElementById(`rec-text-${id}`);
    if (!block) return;

    block.textContent = mode === 'full' ? item.full : item.short;
}

// == –°—á—ë—Ç—á–∏–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π ==

function updateSelectedCount() {
    const counter = document.getElementById('recommendations-selected-count');
    if (!counter) return;

    const count =
        document.querySelectorAll('.rec-card .rec-toggle:checked').length;

    counter.textContent = String(count);
}

// == –°–±–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ ==

function collectSelectedRecommendations() {
    const textarea = document.getElementById('recommendations');
    if (!textarea) return;

    const cards = document.querySelectorAll('.rec-card');
    const texts = [];

    cards.forEach((card) => {
        const checkbox = card.querySelector('.rec-toggle');
        if (!checkbox || !checkbox.checked) return;

        const id = card.dataset.recId;
        const mode = card.dataset.mode || 'short';

        const item = RECOMMENDATIONS_LIBRARY.find((r) => r.id === id);
        if (!item) return;

        const text = mode === 'full' ? item.full : item.short;
        texts.push(`${texts.length + 1}. ${text}`);
    });

    textarea.value = texts.join('\n');
}

// == –û–±—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π ==

function initRecommendationsLibrary() {
    // —Å–Ω–∞—á–∞–ª–∞ —Ä–∏—Å—É–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –≥—Ä—É–ø–ø–∞–º (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
    renderGroupFilters();

    // –∑–∞—Ç–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
    initRecommendationCards();

    const collectBtn =
        document.getElementById('collect-recommendations-button');
    if (collectBtn) {
        collectBtn.addEventListener('click', collectSelectedRecommendations);
    }
}

// –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
document.addEventListener('DOMContentLoaded', initRecommendationsLibrary);

    // –ú–æ–¥–µ–ª—å: –º–∞—Å—Å–∏–≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
// –û–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç: {
//   id: number,
//   name: string,
//   durationValue: string | null,
//   durationType: "days" | "months",
//   times: { [time: string]: string }  // "—É—Ç—Ä–æ–º": "50", ...
//   comment: string
// }

let prescriptions = [];
let rxNextId = 1;
let rxEditingId = null;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
document.addEventListener('DOMContentLoaded', function () {
    const submitBtn = document.getElementById('rx-submit-btn');
    const clearBtn = document.getElementById('rx-clear-btn');
    const timeCheckboxes = document.querySelectorAll('.rx-time-checkbox');

    if (submitBtn) {
        submitBtn.addEventListener('click', onRxSubmit);
    }

    if (clearBtn) {
        clearBtn.addEventListener('click', clearPrescriptionForm);
    }

    // –≤–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–∑ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–µ–∫–±–æ–∫—Å–æ–≤
    timeCheckboxes.forEach(cb => {
        cb.addEventListener('change', function () {
            const time = cb.getAttribute('data-time');
            const doseInput = document.querySelector('.rx-dose-input[data-time="' + time + '"]');
            if (!doseInput) return;
            if (cb.checked) {
                doseInput.disabled = false;
                doseInput.focus();
            } else {
                doseInput.value = '';
                doseInput.disabled = true;
            }
        });
    });

    // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –ø–æ ‚úèÔ∏è / ‚ùå
    const list = document.getElementById('prescriptions_list');
    if (list) {
        list.addEventListener('click', function (event) {
            const target = event.target.closest('.prescription-action-btn');
            if (!target) return;

            const id = parseInt(target.getAttribute('data-id'), 10);
            if (!id) return;

            const action = target.getAttribute('data-action');
            if (action === 'edit') {
                editPrescription(id);
            } else if (action === 'delete') {
                deletePrescription(id);
            }
        });
    }

    renderPrescriptionsList();
});

// –°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
function collectPrescriptionFormData() {
    const nameInput = document.getElementById('rx-name');
    const durationSelect = document.getElementById('rx-duration-value');
    const commentInput = document.getElementById('rx-comment');

    if (!nameInput || !durationSelect || !commentInput) {
        return null;
    }

    const name = nameInput.value.trim();
    if (!name) {
        return null;
    }

    const durationValue = durationSelect.value || null;
    let durationType = 'days';
    const durationTypeRadio = document.querySelector('input[name="rx-duration-type"]:checked');
    if (durationTypeRadio && (durationTypeRadio.value === 'days' || durationTypeRadio.value === 'months')) {
        durationType = durationTypeRadio.value;
    }

    const times = {};
    const timeCheckboxes = document.querySelectorAll('.rx-time-checkbox');
    timeCheckboxes.forEach(cb => {
        if (!cb.checked) return;
        const time = cb.getAttribute('data-time');
        const doseInput = document.querySelector('.rx-dose-input[data-time="' + time + '"]');
        if (!time) return;
        const doseVal = doseInput ? doseInput.value.trim() : '';
        if (doseVal) {
            times[time] = doseVal;
        } else {
            // –≤—Ä–µ–º—è –æ—Ç–º–µ—á–µ–Ω–æ, –Ω–æ –¥–æ–∑–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Äî –≤—Å—ë —Ä–∞–≤–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∫–∞–∫ –≤—Ä–µ–º—è –±–µ–∑ –¥–æ–∑—ã
            times[time] = '';
        }
    });

    const comment = commentInput.value.trim();

    return {
        name,
        durationValue,
        durationType,
        times,
        comment
    };
}

// –ü—Ä–∏–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ —Ñ–æ—Ä–º–µ (–¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
function fillPrescriptionForm(data) {
    const nameInput = document.getElementById('rx-name');
    const durationSelect = document.getElementById('rx-duration-value');
    const commentInput = document.getElementById('rx-comment');
    const timeCheckboxes = document.querySelectorAll('.rx-time-checkbox');

    if (!nameInput || !durationSelect || !commentInput) {
        return;
    }

    nameInput.value = data.name || '';
    durationSelect.value = data.durationValue || '';

    const radios = document.querySelectorAll('input[name="rx-duration-type"]');
    radios.forEach(r => {
        r.checked = (r.value === data.durationType);
    });

    // –°–Ω–∞—á–∞–ª–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å—ë
    timeCheckboxes.forEach(cb => {
        const time = cb.getAttribute('data-time');
        const doseInput = document.querySelector('.rx-dose-input[data-time="' + time + '"]');
        cb.checked = false;
        if (doseInput) {
            doseInput.value = '';
            doseInput.disabled = true;
        }
    });

    // –ó–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ–º —Ç–æ, —á—Ç–æ –µ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã—Ö
    Object.keys(data.times || {}).forEach(time => {
        const cb = document.querySelector('.rx-time-checkbox[data-time="' + time + '"]');
        const doseInput = document.querySelector('.rx-dose-input[data-time="' + time + '"]');
        if (cb) {
            cb.checked = true;
        }
        if (doseInput) {
            doseInput.disabled = false;
            doseInput.value = data.times[time] || '';
        }
    });

    commentInput.value = data.comment || '';
}

// –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –∏ –≤—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
function clearPrescriptionForm() {
    const nameInput = document.getElementById('rx-name');
    const durationSelect = document.getElementById('rx-duration-value');
    const commentInput = document.getElementById('rx-comment');
    const timeCheckboxes = document.querySelectorAll('.rx-time-checkbox');
    const submitBtn = document.getElementById('rx-submit-btn');

    if (nameInput) nameInput.value = '';
    if (durationSelect) durationSelect.value = '';
    if (commentInput) commentInput.value = '';

    timeCheckboxes.forEach(cb => {
        const time = cb.getAttribute('data-time');
        const doseInput = document.querySelector('.rx-dose-input[data-time="' + time + '"]');
        cb.checked = false;
        if (doseInput) {
            doseInput.value = '';
            doseInput.disabled = true;
        }
    });

    rxEditingId = null;
    if (submitBtn) {
        submitBtn.textContent = '–î–æ–±–∞–≤–∏—Ç—å';
    }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ "–î–æ–±–∞–≤–∏—Ç—å"/"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
function onRxSubmit() {
    const formData = collectPrescriptionFormData();
    if (!formData) {
        // –ú–æ–∂–Ω–æ –≤ –±—É–¥—É—â–µ–º –¥–æ–±–∞–≤–∏—Ç—å –º—è–≥–∫—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é / –ø–æ–¥—Å–≤–µ—Ç–∫—É
        return;
    }

    if (rxEditingId === null) {
        // —Ä–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        const newItem = {
            id: rxNextId++,
            name: formData.name,
            durationValue: formData.durationValue,
            durationType: formData.durationType,
            times: formData.times,
            comment: formData.comment
        };
        prescriptions.push(newItem);
    } else {
        // —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        const index = prescriptions.findIndex(p => p.id === rxEditingId);
        if (index !== -1) {
            prescriptions[index] = {
                id: rxEditingId,
                name: formData.name,
                durationValue: formData.durationValue,
                durationType: formData.durationType,
                times: formData.times,
                comment: formData.comment
            };
        }
    }

    renderPrescriptionsList();
    clearPrescriptionForm();
}

// –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
function renderPrescriptionsList() {
    const list = document.getElementById('prescriptions_list');
    if (!list) return;

    list.innerHTML = '';

    if (!prescriptions.length) {
        const empty = document.createElement('div');
        empty.className = 'prescriptions-empty';
        empty.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π.';
        list.appendChild(empty);
        return;
    }

    prescriptions.forEach((p, idx) => {
        const item = document.createElement('div');
        item.className = 'prescription-item';
        item.setAttribute('data-id', String(p.id));

        const titleParts = [];
        titleParts.push((idx + 1) + '. ' + p.name);

        const subParts = [];

        // —Å—Ö–µ–º–∞ –ø—Ä–∏—ë–º–∞
        const timeParts = [];
        Object.keys(p.times || {}).forEach(time => {
            const dose = (p.times[time] || '').trim();
            if (dose) {
                timeParts.push(time + ' ' + dose + ' –º–≥');
            } else {
                timeParts.push(time);
            }
        });

        if (timeParts.length) {
            subParts.push('–ü—Ä–∏—ë–º: ' + timeParts.join(', '));
        }

        if (p.durationValue) {
            const unit = p.durationType === 'months' ? '–º–µ—Å—è—Ü–µ–≤' : '–¥–Ω–µ–π';
            subParts.push('–í —Ç–µ—á–µ–Ω–∏–µ ' + p.durationValue + ' ' + unit);
        }

        const titleText = titleParts.join(' ');
        const subText = subParts.join(' ‚Ä¢ ');

        const mainRow = document.createElement('div');
        mainRow.className = 'prescription-main-row';

        const textBlock = document.createElement('div');
        textBlock.className = 'prescription-main-text';

        const titleEl = document.createElement('div');
        titleEl.className = 'prescription-title';
        titleEl.textContent = titleText;

        textBlock.appendChild(titleEl);

        if (subText) {
            const subEl = document.createElement('div');
            subEl.className = 'prescription-subline';
            subEl.textContent = subText;
            textBlock.appendChild(subEl);
        }

        mainRow.appendChild(textBlock);

        const actions = document.createElement('div');
        actions.className = 'prescription-actions';

        const editBtn = document.createElement('button');
        editBtn.type = 'button';
        editBtn.className = 'prescription-action-btn';
        editBtn.setAttribute('data-action', 'edit');
        editBtn.setAttribute('data-id', String(p.id));
        editBtn.title = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';
        editBtn.innerHTML = '<span>‚úèÔ∏è</span>';

        const deleteBtn = document.createElement('button');
        deleteBtn.type = 'button';
        deleteBtn.className = 'prescription-action-btn danger';
        deleteBtn.setAttribute('data-action', 'delete');
        deleteBtn.setAttribute('data-id', String(p.id));
        deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å';
        deleteBtn.innerHTML = '<span>‚ùå</span>';

        actions.appendChild(editBtn);
        actions.appendChild(deleteBtn);

        mainRow.appendChild(actions);
        item.appendChild(mainRow);

        if (p.comment) {
            const commentRow = document.createElement('div');
            commentRow.className = 'prescription-comment-row';
            const labelSpan = document.createElement('span');
            labelSpan.className = 'prescription-comment-label';
            labelSpan.textContent = '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ';
            const textSpan = document.createElement('span');
            textSpan.textContent = p.comment;
            commentRow.appendChild(labelSpan);
            commentRow.appendChild(textSpan);
            item.appendChild(commentRow);
        }

        list.appendChild(item);
    });
}

// –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
function editPrescription(id) {
    const item = prescriptions.find(p => p.id === id);
    if (!item) return;

    rxEditingId = id;

    const submitBtn = document.getElementById('rx-submit-btn');
    if (submitBtn) {
        submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
    }

    fillPrescriptionForm(item);

    const nameInput = document.getElementById('rx-name');
    if (nameInput) {
        nameInput.focus();
        nameInput.select();
    }
}

// –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
function deletePrescription(id) {
    prescriptions = prescriptions.filter(p => p.id !== id);

    if (rxEditingId === id) {
        // –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ —Ç–æ, —á—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ ‚Äî –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        clearPrescriptionForm();
    }

    renderPrescriptionsList();
}

// –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–µ–∫—Å—Ç: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è
function collectPrescriptionsText() {
    if (!prescriptions.length) {
        return '';
    }

    const lines = [];
    prescriptions.forEach((p, index) => {
        let line = (index + 1) + '. ' + p.name + '. ';

        const timeParts = [];
        Object.keys(p.times || {}).forEach(time => {
            const dose = (p.times[time] || '').trim();
            if (dose) {
                timeParts.push(time + ' ' + dose + ' –º–≥');
            } else {
                timeParts.push(time);
            }
        });

        if (timeParts.length) {
            line += '–ü—Ä–∏—ë–º: ' + timeParts.join(', ') + '. ';
        }

        if (p.durationValue) {
            const unit = p.durationType === 'months' ? '–º–µ—Å—è—Ü–µ–≤' : '–¥–Ω–µ–π';
            line += '–í —Ç–µ—á–µ–Ω–∏–µ ' + p.durationValue + ' ' + unit + '. ';
        }

        if (p.comment) {
            line += '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ' + p.comment + '.';
        }

        lines.push(line.trim());
    });

    return lines.join('<br>');
}


    // TODO: report templates placeholder

    function generateText() {
        // –û–±—â–∏–µ —á–∞—Å—Ç–∏
        const complaints = document.getElementById('complaints').value.trim();
        const anamnesis = document.getElementById('anamnesis').value.trim();
        const dispensary_status = document.getElementById('dispensary_status').value.trim();
        const dispensary_treatment = document.getElementById('dispensary_treatment').value.trim();
        const ill_days = document.getElementById('ill_days').value.trim();
        const self_treatment = document.getElementById('self_treatment').value.trim();
        const dynamics = document.getElementById('dynamics').value.trim();
        const life_history = document.getElementById('life_history').value.trim();

        // –ü–°–ò–•–°–¢–ê–¢–£–°
        //  –°–æ–∑–Ω–∞–Ω–∏–µ –∏ –æ–±—â–µ–Ω–∏–µ
        const consciousness = document.getElementById('consciousness').value || '';
        const behavior = getCheckedTextByName('behavior');
        const appearance = document.getElementById('appearance')?.value.trim() || '';
        const facial_expression = getCheckedTextByName('facial_expression');
        const eye_contact = document.getElementById('eye_contact').value || '';
        const contact = document.getElementById('contact').value || '';
        const conversation = getCheckedTextByName('conversation');
        const answers = getCheckedTextByName('answers');
        const speech = document.getElementById('speech').value || '';

        // –ú—ã—à–ª–µ–Ω–∏–µ
        const thinking_tempo = document.getElementById('thinking_tempo').value || '';
        const thinking_productivity = document.getElementById('thinking_productivity').value || '';
        const thinking_sequence = document.getElementById('thinking_sequence').value || '';
        const thinking_goal = document.getElementById('thinking_goal').value || '';
        const thinking_disorders = getCheckedTextByName('thinking_disorders');
        const thinking_mobility = getCheckedTextByName('thinking_mobility');
        const abstraction = document.getElementById('abstraction').value || '';
        const ideas = collectIdeasText();
        const judgment = getCheckedTextByName('judgment');
        const intellect = document.getElementById('intellect').value || '';
        const vocabulary = document.getElementById('vocabulary').value || '';

        // –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ
        const perceptionDetails = collectPerceptionText();

        // –ü–∞–º—è—Ç—å, –≤–Ω–∏–º–∞–Ω–∏–µ
        const memory = getCheckedTextByName('memory');
        const amnesia = getCheckedTextByName('amnesia');
        const paramnesia = getCheckedTextByName('paramnesia');
        const attention = getCheckedTextByName('attention');

        // –≠–º–æ—Ü–∏–∏
        const mood = document.getElementById('mood').value || '';
        const emotions_stability = document.getElementById('emotions_stability').value || '';
        const emotions = getCheckedTextByName('emotions');
        const aggression = document.getElementById('aggression').value || '';

        // –°—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—Ç–µ–∫—É—â–∏–µ –º—ã—Å–ª–∏/–ø–ª–∞–Ω—ã + –∫–æ–Ω—Ç—Ä—Ñ–∞–∫—Ç–æ—Ä—ã)
        const suicidal_thoughts = document.getElementById('suicidal_thoughts').value || '';
        const suicidal_plans = document.getElementById('suicidal_plans').value || '';
        const contrsuicidal_factors = document.getElementById('contrsuicidal_factors').value || '';

        // –ú–æ—Ç–∏–≤–∞—Ü–∏—è, –¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞ —Å—Ñ–µ—Ä–∞, –ø–ª–∞–Ω—ã, —Å—É–¥–æ—Ä–æ–≥–∏
        const will = document.getElementById('will').value || '';
        const motor = document.getElementById('motor').value.trim();
        const distance = document.getElementById('distance').value || '';
        const insight = document.getElementById('insight').value || '';
        const future_plans = document.getElementById('future_plans').value || '';
        const seizures = document.getElementById('seizures').value || '';

        // –°–æ–Ω, –∞–ø–ø–µ—Ç–∏—Ç
        const sleep = getCheckedTextByName('sleep');
        const appetite = document.getElementById('appetite').value || '';

        // –î–∏–∞–≥–Ω–æ–∑, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
        const diagnosis = document.getElementById('diagnosis').value.trim();
        const recommendations = document.getElementById('recommendations').value.trim();
        const prescriptionsText = collectPrescriptionsText();

        let text = '';

        // –ë–ª–æ–∫–∏ —Å –∂–∏—Ä–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
        text += '<strong>–ñ–∞–ª–æ–±—ã:</strong> ' + (complaints || '&nbsp;') + '<br><br>';
        text += '<strong>–ê–Ω–∞–º–Ω–µ–∑ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</strong> ' + (anamnesis || '&nbsp;') + '<br><br>';
        text += '<strong>–°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —É—á–µ—Ç–µ –≤ –ü–ù–î –∏ –Ω–∞—Ä–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–µ:</strong> ' + (dispensary_status || '&nbsp;') + '<br>';
        text += '<strong>–õ–µ—á–µ–Ω–∏–µ –≤ –ü–ù–î –∏ –Ω–∞—Ä–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–µ:</strong> ' + (dispensary_treatment || '&nbsp;') + '<br>';
        text += '<strong>–°—á–∏—Ç–∞–µ—Ç —Å–µ–±—è –±–æ–ª—å–Ω—ã–º –≤ —Ç–µ—á–µ–Ω–∏–µ (–¥–Ω–µ–π):</strong> ' + (ill_days || '__') + '<br>';
        text += '<strong>–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ:</strong> ' + (self_treatment || '&nbsp;') + '<br>';
        text += '<strong>–î–∏–Ω–∞–º–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</strong> ' + (dynamics || '&nbsp;') + '<br><br>';
        text += '<strong>–ê–Ω–∞–º–Ω–µ–∑ –∂–∏–∑–Ω–∏:</strong> ' + (life_history || '&nbsp;') + '<br><br>';

        text += '<strong>–ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å</strong><br>';

        let psLine1 = '';
        if (consciousness) {
            psLine1 += '–°–æ–∑–Ω–∞–Ω–∏–µ ' + consciousness + '. ';
        }
        if (behavior) {
            psLine1 += '–ü–æ–≤–µ–¥–µ–Ω–∏–µ: ' + behavior + '. ';
        }
        if (appearance) {
            psLine1 += '–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ ' + appearance + '. ';
        }
        if (facial_expression) {
            psLine1 += '–ú–∏–º–∏–∫–∞: ' + facial_expression + '. ';
        }
        if (eye_contact) {
            psLine1 += '–ó—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç ' + eye_contact + '. ';
        }
        if (contact) {
            psLine1 += '–ö–æ–Ω—Ç–∞–∫—Ç ' + contact + '. ';
        }
        if (conversation) {
            psLine1 += '–ë–µ—Å–µ–¥—É–µ—Ç: ' + conversation + '. ';
        }
        if (answers) {
            psLine1 += '–ù–∞ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç: ' + answers + '. ';
        }
        if (speech) {
            psLine1 += '–†–µ—á—å ' + speech + '. ';
        }

        if (psLine1) {
            text += psLine1 + '<br>';
        }

        let thinkingParts = [];
        if (thinking_tempo) thinkingParts.push(thinking_tempo);
        if (thinking_productivity) thinkingParts.push(thinking_productivity);
        if (thinking_sequence) thinkingParts.push(thinking_sequence);
        if (thinking_goal) thinkingParts.push(thinking_goal);
        if (thinking_disorders) thinkingParts.push('—Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏: ' + thinking_disorders);
        if (thinking_mobility) thinkingParts.push('–ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è: ' + thinking_mobility);
        if (abstraction) thinkingParts.push('–∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ' + abstraction);

        if (thinkingParts.length > 0) {
            text += '–ú—ã—à–ª–µ–Ω–∏–µ ' + thinkingParts.join(', ') + '.<br>';
        }

        if (ideas) {
            text += '–ò–¥–µ–∏: ' + ideas + '.<br>';
        }
        if (judgment) {
            text += '–°—É–∂–¥–µ–Ω–∏—è: ' + judgment + '.<br>';
        }
        if (intellect) {
            text += '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç ' + intellect + '.<br>';
        }
        if (vocabulary) {
            text += '–°–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å ' + vocabulary + '.<br>';
        }

        if (perceptionDetails) {
            text += '–û–±–º–∞–Ω—ã –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è: ' + perceptionDetails + '.<br>';
        }

        if (memory) {
            text += '–ü–∞–º—è—Ç—å: ' + memory + '.<br>';
        }
        if (amnesia) {
            text += '–ê–º–Ω–µ–∑–∏—è: ' + amnesia + '.<br>';
        }
        if (paramnesia) {
            text += '–ü–∞—Ä–∞–º–Ω–µ–∑–∏–∏: ' + paramnesia + '.<br>';
        }
        if (attention) {
            text += '–í–Ω–∏–º–∞–Ω–∏–µ: ' + attention + '.<br>';
        }

        let emoLine = '';
        if (mood) emoLine += '–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ' + mood + '. ';
        if (emotions_stability) emoLine += '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ ' + emotions_stability + '. ';
        if (emotions) emoLine += '–•–∞—Ä–∞–∫—Ç–µ—Ä —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π: ' + emotions + '. ';
        if (aggression) emoLine += '–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏: ' + aggression + '. ';
        if (suicidal_thoughts) emoLine += '–°—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Å–º–æ—Ç—Ä–∞: ' + suicidal_thoughts + '. ';
        if (suicidal_plans) emoLine += '–°—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Å–º–æ—Ç—Ä–∞: ' + suicidal_plans + '. ';
        if (contrsuicidal_factors) emoLine += '–ö–æ–Ω—Ç—Ä—Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã: ' + contrsuicidal_factors + '. ';

        if (emoLine) {
            text += emoLine + '<br>';
        }

        // –°—É–∏—Ü–∏–¥–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ –∏–∑ –º—É–ª—å—Ç—á–µ–∫–∞ (–µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –µ—Å—Ç—å)
        if (typeof buildSuicideHistoryText === 'function') {
            const sh = buildSuicideHistoryText();
            if (sh) {
                text += sh + '<br>';
            }
        }

        // –í–æ–ª—è
        if (will) {
            text += '–í–æ–ª—è: ' + will + '.<br>';
        }
        if (motor) {
            text += '–î–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞: ' + motor + '.<br>';
        }
        if (distance) {
            text += '–ß—É–≤—Å—Ç–≤–æ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ ' + distance + '.<br>';
        }
        if (insight) {
            text += '–ö—Ä–∏—Ç–∏–∫–∞ –∫ —Å–≤–æ–µ–º—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—é ' + insight + '.<br>';
        }
        if (future_plans) {
            text += '–ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ ' + future_plans + '.<br>';
        }
        if (seizures) {
            text += '–≠–ø–∏–ª–µ–ø—Ç–∏—Ñ–æ—Ä–º–Ω—ã–µ –ø–∞—Ä–æ–∫—Å–∏–∑–º—ã: ' + seizures + '.<br>';
        }
        if (sleep) {
            text += '–°–æ–Ω: ' + sleep + '.<br>';
        }
        if (appetite) {
            text += '–ê–ø–ø–µ—Ç–∏—Ç ' + appetite + '.<br>';
        }

        text += '<br><strong>–î–∏–∞–≥–Ω–æ–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</strong><br><br>';

        // –î–∏–∞–≥–Ω–æ–∑
        const diagnosisHtml = diagnosis ? diagnosis.replace(/\n/g, '<br>') : '&nbsp;';
        text += '<strong>–î–∏–∞–≥–Ω–æ–∑ (–ú–ö–ë-10):</strong><br>' + diagnosisHtml + '<br><br>';

        // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        const recHtml = recommendations ? recommendations.replace(/\n/g, '<br>') : '&nbsp;';
        text += '<strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>' + recHtml + '<br><br>';

        // –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è
        const prescHtml = prescriptionsText || '&nbsp;';
        text += '<strong>–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è:</strong><br>' + prescHtml + '<br>';

        document.getElementById('result').innerHTML = text;
    }

    function copyResult() {
        const resultDiv = document.getElementById('result');
        const range = document.createRange();
        range.selectNodeContents(resultDiv);
        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
        try {
            document.execCommand('copy');
            alert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.');
        } catch (e) {
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í—ã–¥–µ–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é –∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C.');
        }
        sel.removeAllRanges();
    }

    function prettifyReport(html) {
    return html;
}


    document.addEventListener('DOMContentLoaded', () => {
    if (typeof initRecommendationsLibrary === 'function') {
        initRecommendationsLibrary();
    }

    if (typeof initRecommendationCards === 'function') {
        initRecommendationCards();
    }

    // Additional UI initialization can be placed here
});

  </script>
</body>
</html>
