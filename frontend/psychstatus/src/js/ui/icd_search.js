    // Небольшой список часто используемых рубрик МКБ-10 (можно дополнять)
    const icd10 = [
        { code: 'F10.2', name: 'Психические и поведенческие расстройства, связанные с употреблением алкоголя, синдром зависимости' },
        { code: 'F11.2', name: 'Психические и поведенческие расстройства, связанные с употреблением опиоидов, синдром зависимости' },

        { code: 'F20.0', name: 'Шизофрения параноидная' },
        { code: 'F20.1', name: 'Шизофрения гебефреническая' },
        { code: 'F20.3', name: 'Шизофрения недифференцированная' },
        { code: 'F20.6', name: 'Шизофрения простая' },
        { code: 'F21',   name: 'Шизотипическое расстройство' },
        { code: 'F22.0', name: 'Хроническое бредовое расстройство' },
        { code: 'F23.1', name: 'Острый полиморфный психотический эпизод с симптомами шизофрении' },
        { code: 'F25.0', name: 'Шизоаффективное расстройство, маниакальный тип' },
        { code: 'F25.1', name: 'Шизоаффективное расстройство, депрессивный тип' },

        { code: 'F31.0', name: 'Биполярное аффективное расстройство, текущий эпизод гипомании' },
        { code: 'F31.1', name: 'Биполярное аффективное расстройство, текущий эпизод мании без психотических симптомов' },
        { code: 'F31.2', name: 'Биполярное аффективное расстройство, текущий эпизод мании с психотическими симптомами' },
        { code: 'F31.3', name: 'Биполярное аффективное расстройство, текущий эпизод умеренной или лёгкой депрессии' },
        { code: 'F31.4', name: 'Биполярное аффективное расстройство, текущий эпизод тяжёлой депрессии без психотических симптомов' },

        { code: 'F32.0', name: 'Депрессивный эпизод лёгкой степени' },
        { code: 'F32.1', name: 'Депрессивный эпизод средней степени' },
        { code: 'F32.2', name: 'Депрессивный эпизод тяжёлой степени без психотических симптомов' },
        { code: 'F32.3', name: 'Депрессивный эпизод тяжёлой степени с психотическими симптомами' },
        { code: 'F33.0', name: 'Рекуррентное депрессивное расстройство, текущий эпизод лёгкой степени' },
        { code: 'F33.1', name: 'Рекуррентное депрессивное расстройство, текущий эпизод средней степени' },
        { code: 'F33.2', name: 'Рекуррентное депрессивное расстройство, текущий эпизод тяжёлой степени без психотических симптомов' },

        { code: 'F40.0', name: 'Агорафобия' },
        { code: 'F40.1', name: 'Социальные фобии' },
        { code: 'F41.0', name: 'Паническое расстройство (эпизодическая пароксизмальная тревога)' },
        { code: 'F41.1', name: 'Генерализованное тревожное расстройство' },
        { code: 'F41.2', name: 'Смешанное тревожное и депрессивное расстройство' },

        { code: 'F42.0', name: 'Обсессивно-компульсивное расстройство с преимущественно навязчивыми мыслями или размышлениями' },
        { code: 'F42.1', name: 'Обсессивно-компульсивное расстройство с преимущественно компульсивными действиями (навязчивые ритуалы)' },
        { code: 'F42.2', name: 'Обсессивно-компульсивное расстройство, смешанные навязчивые мысли и действия' },

        { code: 'F43.1', name: 'Посттравматическое стрессовое расстройство' },
        { code: 'F43.2', name: 'Расстройства адаптации' },

        { code: 'F60.3', name: 'Эмоционально неустойчивое расстройство личности (в т. ч. пограничное)' },
        { code: 'F84.0', name: 'Аутизм детский' }
        // сюда можно добавлять свои коды
    ];

    function searchICD() {
        const query = document.getElementById('icd_search').value.trim().toLowerCase();
        const resultsDiv = document.getElementById('icd_results');
        resultsDiv.innerHTML = '';

        if (query.length < 2) {
            return;
        }

        const matches = icd10.filter(item =>
            item.code.toLowerCase().includes(query) ||
            item.name.toLowerCase().includes(query)
        ).slice(0, 30);

        if (matches.length === 0) {
            const empty = document.createElement('div');
            empty.className = 'icd-item';
            empty.textContent = 'Ничего не найдено';
            resultsDiv.appendChild(empty);
            return;
        }

        matches.forEach(item => {
            const div = document.createElement('div');
            div.className = 'icd-item';
            div.textContent = item.code + ' — ' + item.name;

            div.onclick = function () {
                const diag = document.getElementById('diagnosis');
                const line = item.code + ' ' + item.name;

                if (diag.value && !diag.value.endsWith('\n')) {
                    diag.value += '\n';
                }
                if (!diag.value.includes(line)) {
                    diag.value += line;
                }
            };

            resultsDiv.appendChild(div);
        });
    }

    /* ДИНАМИЧЕСКИЕ НАЗНАЧЕНИЯ */

    let prescriptionCounter = 0;

